"use strict";(self.webpackChunkdoc_hub=self.webpackChunkdoc_hub||[]).push([[933],{19229:(r,e,o)=>{o.d(e,{A:()=>n});const n=o.p+"assets/images/jieya-bedc4c4f2138bdf21fcb6a555873dc74.jpg"},28453:(r,e,o)=>{o.d(e,{R:()=>i,x:()=>c});var n=o(96540);const a={},s=n.createContext(a);function i(r){const e=n.useContext(s);return n.useMemo((function(){return"function"==typeof r?r(e):{...e,...r}}),[e,r])}function c(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(a):r.components||a:i(r.components),n.createElement(s.Provider,{value:e},r.children)}},38563:(r,e,o)=>{o.d(e,{A:()=>n});const n=o.p+"assets/images/docker-compose-version-ff9a763562031dcfaae05f2eb377d9d4.jpg"},41055:(r,e,o)=>{o.d(e,{A:()=>n});const n=o.p+"assets/images/docker-compose-installer-762960b3df583e4493623c86824ddf5d.jpg"},48392:(r,e,o)=>{o.d(e,{A:()=>n});const n=o.p+"assets/images/harbor_image_repo-235696b33e4219f0e52e800fe5c0eb1c.jpg"},67685:(r,e,o)=>{o.d(e,{A:()=>n});const n=o.p+"assets/images/offline-installer-1cef458811ad5ee03a01ce07432c693f.jpg"},85712:(r,e,o)=>{o.d(e,{A:()=>n});const n=o.p+"assets/images/login_success-e28894b99f6f41b0477117bc2e7e021a.jpg"},88059:(r,e,o)=>{o.d(e,{A:()=>n});const n=o.p+"assets/images/chmod_perm-f161520f8f689cad345737e8ee9f7eee.jpg"},91624:(r,e,o)=>{o.d(e,{A:()=>n});const n=o.p+"assets/images/harbor_status-dfb1bbee687be251c5019a49a879cb7e.jpg"},96911:(r,e,o)=>{o.r(e),o.d(e,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"CloudNative/Harbor/\u5b89\u88c5Harbor/\u5b89\u88c5Harbor","title":"\u5b89\u88c5 Harbor","description":"\u5b89\u88c5 Harbor","source":"@site/docs/CloudNative/Harbor/\u5b89\u88c5Harbor/\u5b89\u88c5Harbor.md","sourceDirName":"CloudNative/Harbor/\u5b89\u88c5Harbor","slug":"/cloud-native/harbor/install-harbor","permalink":"/en/docs/cloud-native/harbor/install-harbor","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/CloudNative/Harbor/\u5b89\u88c5Harbor/\u5b89\u88c5Harbor.md","tags":[{"inline":true,"label":"Harbor","permalink":"/en/docs/tags/harbor"},{"inline":true,"label":"CloudNative","permalink":"/en/docs/tags/cloud-native"}],"version":"current","frontMatter":{"title":"\u5b89\u88c5 Harbor","description":"\u5b89\u88c5 Harbor","slug":"/cloud-native/harbor/install-harbor","hide_table_of_contents":false,"keywords":["Harbor"],"tags":["Harbor","CloudNative"],"date":"2017-08-01T00:00:00.000Z","categories":["Harbor"]},"sidebar":"harborSidebar","next":{"title":"Harbor \u5b89\u5168\u8bbf\u95ee","permalink":"/en/docs/cloud-native/harbor/secure-harbor"}}');var a=o(74848),s=o(28453);const i={title:"\u5b89\u88c5 Harbor",description:"\u5b89\u88c5 Harbor",slug:"/cloud-native/harbor/install-harbor",hide_table_of_contents:!1,keywords:["Harbor"],tags:["Harbor","CloudNative"],date:new Date("2017-08-01T00:00:00.000Z"),categories:["Harbor"]},c="\u5b89\u88c5 Harbor",l={},d=[{value:"1. Harbor \u7b80\u4ecb",id:"1-harbor-\u7b80\u4ecb",level:2},{value:"1.1 \u4ec0\u4e48\u662f Harbor",id:"11-\u4ec0\u4e48\u662f-harbor",level:3},{value:"1.2 Harbor \u7684\u7279\u6027",id:"12-harbor-\u7684\u7279\u6027",level:3},{value:"1.3 Harbor \u7684\u6784\u6210",id:"13-harbor-\u7684\u6784\u6210",level:3},{value:"2. \u5b89\u88c5\u51c6\u5907",id:"2-\u5b89\u88c5\u51c6\u5907",level:2},{value:"2.1 \u79bb\u7ebf\u4e0b\u8f7d docker-compose",id:"21-\u79bb\u7ebf\u4e0b\u8f7d-docker-compose",level:3},{value:"2.2 \u79bb\u7ebf\u4e0b\u8f7d Harbor",id:"22-\u79bb\u7ebf\u4e0b\u8f7d-harbor",level:3},{value:"3. \u5b89\u88c5 docker-compose",id:"3-\u5b89\u88c5-docker-compose",level:2},{value:"4. \u5b89\u88c5 Harbor",id:"4-\u5b89\u88c5-harbor",level:2},{value:"4.1 \u4e0a\u4f20\u5e76\u89e3\u538b Harbor",id:"41-\u4e0a\u4f20\u5e76\u89e3\u538b-harbor",level:3},{value:"4.2 \u4fee\u6539 harbor.yml",id:"42-\u4fee\u6539-harboryml",level:3},{value:"4.3 \u7f16\u8f91 harbor.yml",id:"43-\u7f16\u8f91-harboryml",level:3},{value:"4.4 \u4fee\u6539 harbor \u6587\u4ef6\u76ee\u5f55\u6743\u9650",id:"44-\u4fee\u6539-harbor-\u6587\u4ef6\u76ee\u5f55\u6743\u9650",level:3},{value:"4.5 \u6267\u884c harbor \u5b89\u88c5\u7a0b\u5e8f",id:"45-\u6267\u884c-harbor-\u5b89\u88c5\u7a0b\u5e8f",level:3},{value:"4.6 \u68c0\u67e5 harbor \u662f\u5426\u53ef\u7528",id:"46-\u68c0\u67e5-harbor-\u662f\u5426\u53ef\u7528",level:3},{value:"4.1 \u767b\u9646 harbor",id:"41-\u767b\u9646-harbor",level:3},{value:"5. Harbor \u6574\u5408 Docker",id:"5-harbor-\u6574\u5408-docker",level:2},{value:"5.1 \u914d\u7f6e harbor",id:"51-\u914d\u7f6e-harbor",level:3},{value:"5.2 \u767b\u9646 Harbor",id:"52-\u767b\u9646-harbor",level:3},{value:"5.2 \u63a8\u9001\u955c\u50cf",id:"52-\u63a8\u9001\u955c\u50cf",level:3}];function t(r){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...r.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"\u5b89\u88c5-harbor",children:"\u5b89\u88c5 Harbor"})}),"\n",(0,a.jsx)(e.h2,{id:"1-harbor-\u7b80\u4ecb",children:"1. Harbor \u7b80\u4ecb"}),"\n",(0,a.jsx)(e.h3,{id:"11-\u4ec0\u4e48\u662f-harbor",children:"1.1 \u4ec0\u4e48\u662f Harbor"}),"\n",(0,a.jsx)(e.p,{children:"Harbor \u662f VMware \u516c\u53f8\u5f00\u6e90\u7684\u4f01\u4e1a\u7ea7 Docker Registry \u9879\u76ee\uff0c\u5176\u76ee\u6807\u662f\u5e2e\u52a9\u7528\u6237\u8fc5\u901f\u642d\u5efa\u4e00\u4e2a\u4f01\u4e1a\u7ea7\u7684 Docker Registry \u670d\u52a1\u3002plainplainplainplainplainplainplain"}),"\n",(0,a.jsx)(e.p,{children:"Harbor\u4ee5 Docker \u516c\u53f8\u5f00\u6e90\u7684 Registry \u4e3a\u57fa\u7840\uff0c\u63d0\u4f9b\u4e86\u56fe\u5f62\u7ba1\u7406 UI \u3001\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236(Role Based AccessControl) \u3001AD/LDAP \u96c6\u6210\u3001\u4ee5\u53ca\u5ba1\u8ba1\u65e5\u5fd7(Auditlogging) \u7b49\u4f01\u4e1a\u7528\u6237\u9700\u6c42\u7684\u529f\u80fd\uff0c\u540c\u65f6\u8fd8\u539f\u751f\u652f\u6301\u4e2d\u6587\u3002"}),"\n",(0,a.jsx)(e.p,{children:"Harbor \u7684\u6bcf\u4e2a\u7ec4\u4ef6\u90fd\u662f\u4ee5 Docker \u5bb9\u5668\u7684\u5f62\u5f0f\u6784\u5efa\u7684\uff0c\u4f7f\u7528 docker-compose \u6765\u5bf9\u5b83\u8fdb\u884c\u90e8\u7f72\u3002\u7528\u4e8e\u90e8\u7f72 Harbor \u7684 docker-compose \u6a21\u677f\u4f4d\u4e8e harbor/docker-compose.yml\u3002"}),"\n",(0,a.jsx)(e.h3,{id:"12-harbor-\u7684\u7279\u6027",children:"1.2 Harbor \u7684\u7279\u6027"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsx)(e.li,{children:"\u57fa\u4e8e\u89d2\u8272\u63a7\u5236\uff1a\u7528\u6237\u548c\u4ed3\u5e93\u90fd\u662f\u57fa\u4e8e\u9879\u76ee\u8fdb\u884c\u7ec4\u7ec7\u7684\uff0c\u800c\u7528\u6237\u5728\u9879\u76ee\u4e2d\u53ef\u4ee5\u62e5\u6709\u4e0d\u540c\u7684\u6743\u9650\u3002"}),"\n",(0,a.jsx)(e.li,{children:"\u57fa\u4e8e\u955c\u50cf\u7684\u590d\u5236\u7b56\u7565\uff1a\u955c\u50cf\u53ef\u4ee5\u5728\u591a\u4e2a Harbor \u5b9e\u4f8b\u4e4b\u95f4\u8fdb\u884c\u590d\u5236\uff08\u540c\u6b65\uff09\u3002"}),"\n",(0,a.jsx)(e.li,{children:"\u652f\u6301 LDAP/AD\uff1aHarbor \u53ef\u4ee5\u96c6\u6210\u4f01\u4e1a\u5185\u90e8\u5df2\u6709\u7684 AD/LDAP\uff08\u7c7b\u4f3c\u6570\u636e\u5e93\u7684\u4e00\u5f20\u8868\uff09\uff0c\u7528\u4e8e\u5bf9\u5df2\u7ecf\u5b58\u5728\u7684\u7528\u6237\u8ba4\u8bc1\u548c\u7ba1\u7406\u3002"}),"\n",(0,a.jsx)(e.li,{children:"\u955c\u50cf\u5220\u9664\u548c\u5783\u573e\u56de\u6536\uff1a\u955c\u50cf\u53ef\u4ee5\u88ab\u5220\u9664\uff0c\u4e5f\u53ef\u4ee5\u56de\u6536\u955c\u50cf\u5360\u7528\u7684\u7a7a\u95f4\u3002"}),"\n",(0,a.jsx)(e.li,{children:"\u56fe\u5f62\u5316\u7528\u6237\u754c\u9762\uff1a\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\u6765\u6d4f\u89c8\uff0c\u641c\u7d22\u955c\u50cf\u4ed3\u5e93\u4ee5\u53ca\u5bf9\u9879\u76ee\u8fdb\u884c\u7ba1\u7406\u3002"}),"\n",(0,a.jsx)(e.li,{children:"\u5ba1\u8ba1\u7ba1\u7406\uff1a\u6240\u6709\u9488\u5bf9\u955c\u50cf\u4ed3\u5e93\u7684\u64cd\u4f5c\u90fd\u53ef\u4ee5\u88ab\u8bb0\u5f55\u8ffd\u6eaf\uff0c\u7528\u4e8e\u5ba1\u8ba1\u7ba1\u7406\u3002"}),"\n",(0,a.jsx)(e.li,{children:"\u652f\u6301 RESTful API\uff1aRESTful API \u63d0\u4f9b\u7ed9\u7ba1\u7406\u5458\u5bf9\u4e8e Harbor \u66f4\u591a\u7684\u64cd\u63a7, \u4f7f\u5f97\u4e0e\u5176\u5b83\u7ba1\u7406\u8f6f\u4ef6\u96c6\u6210\u53d8\u5f97\u66f4\u5bb9\u6613\u3002"}),"\n",(0,a.jsx)(e.li,{children:"Harbor \u548c docker registry \u7684\u5173\u7cfb\uff1aHarbor \u5b9e\u8d28\u4e0a\u662f\u5bf9 docker registry \u505a\u4e86\u5c01\u88c5\uff0c\u6269\u5c55\u4e86\u81ea\u5df1\u7684\u4e1a\u52a1\u6a21\u677f\u3002"}),"\n"]}),"\n",(0,a.jsx)(e.h3,{id:"13-harbor-\u7684\u6784\u6210",children:"1.3 Harbor \u7684\u6784\u6210"}),"\n",(0,a.jsx)(e.p,{children:"Harbor \u5728\u67b6\u6784\u4e0a\u4e3b\u8981\u6709 Proxy\u3001Registry\u3001Core services\u3001Database\uff08Harbor-db\uff09\u3001Log collector\uff08Harbor-log\uff09\u3001Job services \u516d\u4e2a\u7ec4\u4ef6\u3002"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsx)(e.li,{children:"Proxy: \u662f\u4e00\u4e2a nginx \u7684\u524d\u7aef\u4ee3\u7406\uff0cHarbor \u7684 Registry\u3001UI\u3001Token \u670d\u52a1\u7b49\u7ec4\u4ef6\uff0c\u90fd\u5904\u5728 nginx \u53cd\u5411\u4ee3\u7406\u540e\u8fb9\u3002 \u8be5\u4ee3\u7406\u5c06\u6765\u81ea\u6d4f\u89c8\u5668\u3001docker clients \u7684\u8bf7\u6c42\u8f6c\u53d1\u5230\u540e\u7aef\u4e0d\u540c\u7684\u670d\u52a1\u4e0a\u3002"}),"\n",(0,a.jsx)(e.li,{children:"Registry: \u8d1f\u8d23\u50a8\u5b58 Docker \u955c\u50cf\uff0c\u5e76\u5904\u7406 Docker push/pull \u547d\u4ee4\u3002\u7531\u4e8e\u8981\u5bf9\u7528\u6237\u8fdb\u884c\u8bbf\u95ee\u63a7\u5236\uff0c\u5373\u4e0d\u540c\u7528\u6237\u5bf9 Docker \u955c\u50cf \u6709\u4e0d\u540c\u7684\u8bfb\u5199\u6743\u9650\uff0cRegistry \u4f1a\u6307\u5411\u4e00\u4e2a Token \u670d\u52a1\uff0c\u5f3a\u5236\u7528\u6237\u7684\u6bcf\u6b21 Docker pull/push \u8bf7\u6c42\u90fd\u8981\u643a\u5e26\u4e00\u4e2a\u5408\u6cd5\u7684 Token\uff0c Registry \u4f1a\u901a\u8fc7\u516c\u94a5\u5bf9 Token \u8fdb\u884c\u89e3\u5bc6\u9a8c\u8bc1\u3002"}),"\n",(0,a.jsxs)(e.li,{children:["Core services: Harbor \u7684\u6838\u5fc3\u529f\u80fd\uff0c\u4e3b\u8981\u63d0\u4f9b\u4ee5\u4e0b 3 \u4e2a\u670d\u52a1:","\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"UI\uff08harbor-ui\uff09: \u63d0\u4f9b\u56fe\u5f62\u5316\u754c\u9762\uff0c\u5e2e\u52a9\u7528\u6237\u7ba1\u7406 Registry \u4e0a\u7684\u955c\u50cf\uff08image\uff09, \u5e76\u5bf9\u7528\u6237\u8fdb\u884c\u6388\u6743\u3002"}),"\n",(0,a.jsx)(e.li,{children:"WebHook\uff1a\u4e3a\u4e86\u53ca\u65f6\u83b7\u53d6 Registry \u4e0a image \u72b6\u6001\u53d8\u5316\u7684\u60c5\u51b5\uff0c\u5728 Registry \u4e0a\u914d\u7f6e Webhook\uff0c\u628a\u72b6\u6001\u53d8\u5316\u4f20\u9012\u7ed9 UI \u6a21\u5757\u3002"}),"\n",(0,a.jsx)(e.li,{children:"Token \u670d\u52a1\uff1a\u8d1f\u8d23\u6839\u636e\u7528\u6237\u6743\u9650\u7ed9\u6bcf\u4e2a Docker push/pull \u547d\u4ee4\u7b7e\u53d1 Token\u3002Docker \u5ba2\u6237\u7aef\u5411 Registry \u670d\u52a1\u53d1\u8d77\u7684\u8bf7\u6c42\uff0c \u5982\u679c\u4e0d\u5305\u542b Token\uff0c\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230 Token \u670d\u52a1\uff0c\u83b7\u5f97 Token \u540e\u518d\u91cd\u65b0\u5411 Registry \u8fdb\u884c\u8bf7\u6c42\u3002"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(e.li,{children:"Database\uff08harbor-db\uff09\uff1a\u4e3a core services \u63d0\u4f9b\u6570\u636e\u5e93\u670d\u52a1\uff0c\u8d1f\u8d23\u50a8\u5b58\u7528\u6237\u6743\u9650\u3001\u5ba1\u8ba1\u65e5\u5fd7\u3001Docker \u955c\u50cf\u5206\u7ec4\u4fe1\u606f\u7b49\u6570\u636e\u3002"}),"\n",(0,a.jsx)(e.li,{children:"Job services: \u4e3b\u8981\u7528\u4e8e\u955c\u50cf\u590d\u5236\uff0c\u672c\u5730\u955c\u50cf\u53ef\u4ee5\u88ab\u540c\u6b65\u5230\u8fdc\u7a0b Harbor \u5b9e\u4f8b\u4e0a\u3002"}),"\n",(0,a.jsx)(e.li,{children:"Log collector\uff08harbor-log\uff09: \u8d1f\u8d23\u6536\u96c6\u5176\u4ed6\u7ec4\u4ef6\u7684\u65e5\u5fd7\u5230\u4e00\u4e2a\u5730\u65b9\u3002"}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"Harbor \u7684\u6bcf\u4e2a\u7ec4\u4ef6\u90fd\u662f\u4ee5 Docker \u5bb9\u5668\u7684\u5f62\u5f0f\u6784\u5efa\u7684\uff0c\u56e0\u6b64\uff0c\u4f7f\u7528 Docker Compose \u6765\u5bf9\u5b83\u8fdb\u884c\u90e8\u7f72\u3002"}),"\n",(0,a.jsx)(e.p,{children:"\u603b\u5171\u5206\u4e3a 7 \u4e2a\u5bb9\u5668\u8fd0\u884c\uff0c\u901a\u8fc7\u5728 docker-compose.yml \u6240\u5728\u76ee\u5f55\u4e2d\u6267\u884c docker-compose ps \u547d\u4ee4\u6765\u67e5\u770b\uff0c \u540d\u79f0\u5206\u522b\u4e3a\uff1anginx\u3001harbor-jobservice\u3001harbor-ui\u3001harbor-db\u3001harbor-adminserver\u3001registry\u3001harbor-log\u3002"}),"\n",(0,a.jsx)(e.p,{children:"\u5176\u4e2d harbor-adminserver \u4e3b\u8981\u662f\u4f5c\u4e3a\u4e00\u4e2a\u540e\u7aef\u7684\u914d\u7f6e\u6570\u636e\u7ba1\u7406\uff0c\u5e76\u6ca1\u6709\u592a\u591a\u7684\u5176\u4ed6\u529f\u80fd\u3002harbor-ui \u6240\u8981\u64cd\u4f5c\u7684\u6240\u6709\u6570\u636e\u90fd\u901a\u8fc7 harbor-adminserver \u8fd9\u6837\u4e00\u4e2a\u6570\u636e\u914d\u7f6e\u7ba1\u7406\u4e2d\u5fc3\u6765\u5b8c\u6210\u3002"}),"\n",(0,a.jsx)(e.h2,{id:"2-\u5b89\u88c5\u51c6\u5907",children:"2. \u5b89\u88c5\u51c6\u5907"}),"\n",(0,a.jsx)(e.h3,{id:"21-\u79bb\u7ebf\u4e0b\u8f7d-docker-compose",children:"2.1 \u79bb\u7ebf\u4e0b\u8f7d docker-compose"}),"\n",(0,a.jsx)(e.p,{children:"\u4e0b\u8f7d docker-compose \u79bb\u7ebf\u5b89\u88c5\u5305\uff0c\u5730\u5740\u5982\u4e0b:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"https://github.com/docker/compose/releases/tag/v2.24.5\n"})}),"\n",(0,a.jsxs)(e.p,{children:["\u6211\u4eec\u9009\u62e9\u5b89\u88c5\u6700\u65b0\u7248\u672c",(0,a.jsx)(e.code,{children:"docker-compose-linux-x86_64"}),":"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{alt:"img",src:o(41055).A+"",width:"2876",height:"1404"})}),"\n",(0,a.jsx)(e.h3,{id:"22-\u79bb\u7ebf\u4e0b\u8f7d-harbor",children:"2.2 \u79bb\u7ebf\u4e0b\u8f7d Harbor"}),"\n",(0,a.jsx)(e.p,{children:"\u4e0b\u8f7d harbor \u79bb\u7ebf\u5b89\u88c5\u5305\uff0c\u4e0b\u8f7d\u5730\u5740\u5982\u4e0b\uff1a"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:"https://github.com/goharbor/harbor/releases"})}),"\n",(0,a.jsxs)(e.p,{children:["\u8fd9\u91cc\u6211\u4eec\u9009\u62e9\u5b89\u88c5\u6700\u65b0\u7248\u672c",(0,a.jsx)(e.code,{children:"harbor-offline-installer-v2.9.2.tgz"}),"\u3002"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{alt:"img",src:o(67685).A+"",width:"2840",height:"1222"})}),"\n",(0,a.jsx)(e.h2,{id:"3-\u5b89\u88c5-docker-compose",children:"3. \u5b89\u88c5 docker-compose"}),"\n",(0,a.jsxs)(e.p,{children:["\u5c06\u4e0b\u8f7d\u7684 docker-compose \u4e0a\u4f20\u5230\u670d\u52a1\u5668\uff0c\u5e76\u590d\u5236\u5230 ",(0,a.jsx)(e.code,{children:"/usr/local/bin/docker-compose"}),":"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"sudo mv docker-compose-linux-x86_64 /usr/local/bin/docker-compose\nsudo chmod +x /usr/local/bin/docker-compose\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u67e5\u770b\u7248\u672c\uff1a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"docker-compose -v\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{alt:"img",src:o(38563).A+"",width:"1840",height:"94"})}),"\n",(0,a.jsx)(e.h2,{id:"4-\u5b89\u88c5-harbor",children:"4. \u5b89\u88c5 Harbor"}),"\n",(0,a.jsx)(e.h3,{id:"41-\u4e0a\u4f20\u5e76\u89e3\u538b-harbor",children:"4.1 \u4e0a\u4f20\u5e76\u89e3\u538b Harbor"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"tar zxvf harbor-offline-installer-v2.9.2.tgz\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u89e3\u538b\u540e:"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{alt:"\u89e3\u538b\u7f29",src:o(19229).A+"",width:"1712",height:"274"})}),"\n",(0,a.jsx)(e.h3,{id:"42-\u4fee\u6539-harboryml",children:"4.2 \u4fee\u6539 harbor.yml"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"cp harbor.yml.tmpl harbor.yml\n"})}),"\n",(0,a.jsx)(e.h3,{id:"43-\u7f16\u8f91-harboryml",children:"4.3 \u7f16\u8f91 harbor.yml"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"vim harbor.yml\n"})}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsx)(e.li,{children:"\u4fee\u6539 hostname: 127.0.0.1"}),"\n",(0,a.jsx)(e.li,{children:"\u5982\u679c\u4e0d\u9700 https \u8bbf\u95ee\u5219\u5c06 https \u90e8\u5206\u6ce8\u91ca"}),"\n",(0,a.jsx)(e.li,{children:"\u4fee\u6539 data_volume: /data/harbor/data"}),"\n"]}),"\n",(0,a.jsx)(e.h3,{id:"44-\u4fee\u6539-harbor-\u6587\u4ef6\u76ee\u5f55\u6743\u9650",children:"4.4 \u4fee\u6539 harbor \u6587\u4ef6\u76ee\u5f55\u6743\u9650"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"chmod -R 777 harbor\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{alt:"chmod",src:o(88059).A+"",width:"1912",height:"72"})}),"\n",(0,a.jsx)(e.h3,{id:"45-\u6267\u884c-harbor-\u5b89\u88c5\u7a0b\u5e8f",children:"4.5 \u6267\u884c harbor \u5b89\u88c5\u7a0b\u5e8f"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u5148\u542f\u52a8docker\nsystemctl start docker\n\n# \u6267\u884c\u5b89\u88c5\u811a\u672c\nsh ./install.sh\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u5b89\u88c5\u65e5\u5fd7:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-txt",children:"[Step 0]: checking if docker is installed ...\n\nNote: docker version: 25.0.2\n\n[Step 1]: checking docker-compose is installed ...\n\nNote: docker-compose version: 2.24.5\n\n[Step 2]: loading Harbor images ...\nLoaded image: goharbor/harbor-log:v2.9.2\nLoaded image: goharbor/harbor-db:v2.9.2\nLoaded image: goharbor/harbor-registryctl:v2.9.2\nLoaded image: goharbor/nginx-photon:v2.9.2\nLoaded image: goharbor/redis-photon:v2.9.2\nLoaded image: goharbor/registry-photon:v2.9.2\nLoaded image: goharbor/trivy-adapter-photon:v2.9.2\nLoaded image: goharbor/prepare:v2.9.2\nLoaded image: goharbor/harbor-portal:v2.9.2\nLoaded image: goharbor/harbor-core:v2.9.2\nLoaded image: goharbor/harbor-jobservice:v2.9.2\nLoaded image: goharbor/harbor-exporter:v2.9.2\n\n\n[Step 3]: preparing environment ...\n\n[Step 4]: preparing harbor configs ...\nprepare base dir is set to /home/installer/harbor\nWARNING:root:WARNING: HTTP protocol is insecure. Harbor will deprecate http protocol in the future. Please make sure to upgrade to https\nGenerated configuration file: /config/portal/nginx.conf\nGenerated configuration file: /config/log/logrotate.conf\nGenerated configuration file: /config/log/rsyslog_docker.conf\nGenerated configuration file: /config/nginx/nginx.conf\nGenerated configuration file: /config/core/env\nGenerated configuration file: /config/core/app.conf\nGenerated configuration file: /config/registry/config.yml\nGenerated configuration file: /config/registryctl/env\nGenerated configuration file: /config/registryctl/config.yml\nGenerated configuration file: /config/db/env\nGenerated configuration file: /config/jobservice/env\nGenerated configuration file: /config/jobservice/config.yml\nGenerated and saved secret to file: /data/secret/keys/secretkey\nSuccessfully called func: create_root_cert\nGenerated configuration file: /compose_location/docker-compose.yml\nClean up the input dir\n\n\nNote: stopping existing Harbor instance ...\n\n\n[Step 5]: starting Harbor ...\n[+] Running 9/10\n \u2807 Network harbor_harbor        Created                                                                              1.8s \n \u2714 Container harbor-log         Started                                                                              0.4s \n \u2714 Container harbor-db          Started                                                                              1.0s \n \u2714 Container registry           Started                                                                              1.1s \n \u2714 Container redis              Started                                                                              0.9s \n \u2714 Container harbor-portal      Started                                                                              0.9s \n \u2714 Container registryctl        Started                                                                              1.1s \n \u2714 Container harbor-core        Started                                                                              1.2s \n \u2714 Container nginx              Started                                                                              1.7s \n \u2714 Container harbor-jobservice  Started                                                                              1.7s\n \u2714 ----Harbor has been installed and started successfully.----\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u81f3\u6b64 Harbor \u5b89\u88c5\u5b8c\u6210\u3002"}),"\n",(0,a.jsx)(e.h3,{id:"46-\u68c0\u67e5-harbor-\u662f\u5426\u53ef\u7528",children:"4.6 \u68c0\u67e5 harbor \u662f\u5426\u53ef\u7528"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"docker ps | grep harbor\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{alt:"harbor_status",src:o(91624).A+"",width:"1984",height:"726"})}),"\n",(0,a.jsx)(e.h3,{id:"41-\u767b\u9646-harbor",children:"4.1 \u767b\u9646 harbor"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"#\u8bbf\u95ee\nhttp://127.0.0.1:8443\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u767b\u9646\uff0c\u7528\u6237\u540d\u4e3a: admin , \u7ba1\u7406\u5bc6\u7801\u9700\u8981\u5728 harbor.yml \u4e2d\u67e5\u627e, \u9ed8\u8ba4\u5bc6\u7801\u4e3a: Harbor12345"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{alt:"login_success",src:o(85712).A+"",width:"2484",height:"1412"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-###",metastring:"4.9 \u8bbe\u7f6e Harbor \u5f00\u673a\u81ea\u52a8\u542f\u52a8",children:"\n1. \u7f16\u8f91\u670d\u52a1\u6587\u4ef6\uff1a\n\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u521b\u5efa\u5e76\u7f16\u8f91 systemd \u670d\u52a1\u6587\u4ef6:\n```bash\nsudo vim /etc/systemd/system/harbor.service\n```\n\n2. \u5199\u5165\u4ee5\u4e0b\u5185\u5bb9:\n```bash\n[Unit]\nDescription=Harbor Docker Compose Service\nAfter=network.target docker.service\nRequires=docker.service\n\n[Service]\nWorkingDirectory=/root/harbor\nExecStart=/usr/local/bin/docker-compose -f /opt/harbor/docker-compose.yml up -d\nExecStop=/usr/local/bin/docker-compose -f /opt/harbor/docker-compose.yml down\nRestart=always\nUser=root\nGroup=root\n\n[Install]\nWantedBy=multi-user.target\n```\n\nWorkingDirectory: \u6307\u5b9a Harbor \u7684\u76ee\u5f55\u3002\n\nExecStart: \u542f\u52a8 Docker Compose \u7684\u547d\u4ee4\uff0c\u786e\u4fdd\u8def\u5f84 /usr/local/bin/docker-compose \u662f\u6b63\u786e\u7684\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7 which docker-compose \u6765\u786e\u8ba4\u3002\n\nExecStop: \u505c\u6b62 Docker Compose \u7684\u547d\u4ee4\u3002\n\nUser \u548c Group: \u8fd0\u884c Docker Compose \u7684\u7528\u6237\u548c\u7ec4\u3002\u5982\u679c\u4f60\u5e0c\u671b\u4ee5\u975e root \u7528\u6237\u8eab\u4efd\u8fd0\u884c\uff0c\u53ef\u4ee5\u66ff\u6362\u4e3a\u5bf9\u5e94\u7684\u7528\u6237\u548c\u7ec4\u3002\n\n3. \u91cd\u65b0\u52a0\u8f7d systemd \u914d\u7f6e\n```bash\nsudo systemctl daemon-reload\n```\n4. \u542f\u7528\u5e76\u542f\u52a8\u670d\u52a1\n\u4f7f\u670d\u52a1\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u81ea\u52a8\u542f\u52a8:\n```bash\nsudo systemctl enable harbor.service\n```\n\u542f\u52a8\u670d\u52a1\u5e76\u68c0\u67e5\u72b6\u6001:\n```bash\nsudo systemctl start harbor.service\nsudo systemctl status harbor.service\n```\n5. \u9a8c\u8bc1\u670d\u52a1\u72b6\u6001\n\u67e5\u770b\u670d\u52a1\u65e5\u5fd7\u4ee5\u786e\u4fdd Harbor \u6b63\u5e38\u542f\u52a8\uff1a\n```bash\nsudo journalctl -u harbor.service\n```\n\u901a\u8fc7\u8fd9\u4e9b\u6b65\u9aa4\uff0c\u53ef\u4ee5\u5c06 Harbor \u914d\u7f6e\u4e3a\u4e00\u4e2a systemd \u670d\u52a1\uff0c\u4f7f\u5176\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u81ea\u52a8\u8fd0\u884c\u3002\n"})}),"\n",(0,a.jsx)(e.h2,{id:"5-harbor-\u6574\u5408-docker",children:"5. Harbor \u6574\u5408 Docker"}),"\n",(0,a.jsx)(e.h3,{id:"51-\u914d\u7f6e-harbor",children:"5.1 \u914d\u7f6e harbor"}),"\n",(0,a.jsx)(e.p,{children:"\u5728\u53e6\u4e00\u53f0\u673a\u5668\u4e0a\u914d\u7f6e"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"## \u7f16\u8f91\nvi /etc/docker/daemon.json\n\n## \u5982\u679c\u6ca1\u6709\u6587\u4ef6\u5219\u4f9d\u6b21\u6267\u884c\nmkdir -p /etc/docker\ntouch daemon.json\nvi daemon.json\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u6dfb\u52a0\u5185\u5bb9:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-json",children:'{\n  "insecure-registries":["127.0.0.1:8443"]\n}\n'})}),"\n",(0,a.jsx)(e.h3,{id:"52-\u767b\u9646-harbor",children:"5.2 \u767b\u9646 Harbor"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"docker login -u admin -p Harbor12345 127.0.0.1:8443\n"})}),"\n",(0,a.jsx)(e.h3,{id:"52-\u63a8\u9001\u955c\u50cf",children:"5.2 \u63a8\u9001\u955c\u50cf"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"#1.\u767b\u9646Harbor\ndocker login -u admin -p Harbor12345 127.0.0.1:8443\n\n#WARNING! Using --password via the CLI is insecure. Use --password-stdin.\n#Login Succeeded\n\n#2.\u5c06\u955c\u50cf\u6253\u4e0a\u6807\u7b7e\ndocker tag redis:latest 127.0.0.1:8443/library/redis:latest\n \n#3.\u63a8\u9001\u955c\u50cf\ndocker push 127.0.0.1:8443/library/redis:latest\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u63a8\u9001\u6210\u529f:"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{alt:"harbor_image_repo.jpg",src:o(48392).A+"",width:"2950",height:"1472"})})]})}function h(r={}){const{wrapper:e}={...(0,s.R)(),...r.components};return e?(0,a.jsx)(e,{...r,children:(0,a.jsx)(t,{...r})}):t(r)}}}]);