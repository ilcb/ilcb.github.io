"use strict";(self.webpackChunkdoc_hub=self.webpackChunkdoc_hub||[]).push([[2297],{2883:(n,e,t)=>{t.d(e,{A:()=>i});const i=t.p+"assets/images/bean\u521d\u59cb\u5316-79514869594502a67cf3bf30625216e9.jpg"},28453:(n,e,t)=>{t.d(e,{R:()=>a,x:()=>s});var i=t(96540);const r={},o=i.createContext(r);function a(n){const e=i.useContext(o);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:a(n.components),i.createElement(o.Provider,{value:e},n.children)}},68847:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"Backend/Spring/Spring\u4e2dBean\u7684\u751f\u547d\u5468\u671f/Spring\u4e2dBean\u7684\u751f\u547d\u5468\u671f","title":"Spring \u4e2d Bean \u7684\u751f\u547d\u5468\u671f","description":"Spring \u4e2d Bean \u7684\u751f\u547d\u5468\u671f","source":"@site/docs/Backend/Spring/Spring\u4e2dBean\u7684\u751f\u547d\u5468\u671f/Spring\u4e2dBean\u7684\u751f\u547d\u5468\u671f.md","sourceDirName":"Backend/Spring/Spring\u4e2dBean\u7684\u751f\u547d\u5468\u671f","slug":"/backend/spring/bean-lifecycle","permalink":"/docs/backend/spring/bean-lifecycle","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Backend/Spring/Spring\u4e2dBean\u7684\u751f\u547d\u5468\u671f/Spring\u4e2dBean\u7684\u751f\u547d\u5468\u671f.md","tags":[{"inline":true,"label":"Spring","permalink":"/docs/tags/spring"}],"version":"current","frontMatter":{"title":"Spring \u4e2d Bean \u7684\u751f\u547d\u5468\u671f","description":"Spring \u4e2d Bean \u7684\u751f\u547d\u5468\u671f","slug":"/backend/spring/bean-lifecycle","hide_table_of_contents":false,"keywords":["Spring"],"tags":["Spring"],"date":"2017-08-01T00:00:00.000Z","categories":["Spring"]},"sidebar":"backendSideBar","previous":{"title":"Spring AOP \u5b9e\u4f8b","permalink":"/docs/backend/spring/aop-example"},"next":{"title":"spring \u4e8b\u52a1\u7ba1\u7406","permalink":"/docs/backend/spring/bean-tx"}}');var r=t(74848),o=t(28453);const a={title:"Spring \u4e2d Bean \u7684\u751f\u547d\u5468\u671f",description:"Spring \u4e2d Bean \u7684\u751f\u547d\u5468\u671f",slug:"/backend/spring/bean-lifecycle",hide_table_of_contents:!1,keywords:["Spring"],tags:["Spring"],date:new Date("2017-08-01T00:00:00.000Z"),categories:["Spring"]},s=void 0,c={},l=[{value:"1.\u80cc\u666f",id:"1\u80cc\u666f",level:2},{value:"2. \u751f\u547d\u5468\u671f\u63a5\u53e3\u65b9\u6cd5\u5206\u7c7b",id:"2-\u751f\u547d\u5468\u671f\u63a5\u53e3\u65b9\u6cd5\u5206\u7c7b",level:2},{value:"3. Bean \u751f\u547d\u5468\u671f",id:"3-bean-\u751f\u547d\u5468\u671f",level:2},{value:"4. \u4ee3\u7801\u9a8c\u8bc1",id:"4-\u4ee3\u7801\u9a8c\u8bc1",level:2},{value:"4.1 \u5f15\u5165\u4f9d\u8d56",id:"41-\u5f15\u5165\u4f9d\u8d56",level:3},{value:"4.2 Bean \u5b9a\u4e49",id:"42-bean-\u5b9a\u4e49",level:3},{value:"4.3 InstantiationAwareBeanPostProcessor \u5b9a\u4e49",id:"43-instantiationawarebeanpostprocessor-\u5b9a\u4e49",level:3},{value:"4.4 BeanPostProcessor \u5b9a\u4e49",id:"44-beanpostprocessor-\u5b9a\u4e49",level:3},{value:"4.5 \u6d4b\u8bd5\u5165\u53e3",id:"45-\u6d4b\u8bd5\u5165\u53e3",level:3},{value:"4.6 \u6267\u884c\u7ed3\u679c",id:"46-\u6267\u884c\u7ed3\u679c",level:3},{value:"5.LifeCycle",id:"5lifecycle",level:2},{value:"5.1 Lifecycle",id:"51-lifecycle",level:3},{value:"5.1.1 \u4e3a\u4ec0\u4e48\u8981\u7528 Lifecycle",id:"511-\u4e3a\u4ec0\u4e48\u8981\u7528-lifecycle",level:4},{value:"5.1.2 \u63a5\u53e3\u65b9\u6cd5",id:"512-\u63a5\u53e3\u65b9\u6cd5",level:4},{value:"5.1.3 \u4ee3\u7801\u793a\u4f8b",id:"513-\u4ee3\u7801\u793a\u4f8b",level:4},{value:"5.2 SmartLifecycle",id:"52-smartlifecycle",level:3},{value:"5.2.1 \u4e3a\u4ec0\u4e48\u8981\u7528 SmartLifecycle",id:"521-\u4e3a\u4ec0\u4e48\u8981\u7528-smartlifecycle",level:4},{value:"5.2.2 \u63a5\u53e3\u65b9\u6cd5",id:"522-\u63a5\u53e3\u65b9\u6cd5",level:4},{value:"5.2.3 \u4f7f\u7528\u573a\u666f",id:"523-\u4f7f\u7528\u573a\u666f",level:4},{value:"5.2.4 \u4ee3\u7801\u793a\u4f8b",id:"524-\u4ee3\u7801\u793a\u4f8b",level:4},{value:"5.2.5 \u603b\u7ed3",id:"525-\u603b\u7ed3",level:4}];function p(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h2,{id:"1\u80cc\u666f",children:"1.\u80cc\u666f"}),"\n",(0,r.jsx)(e.p,{children:"\u672c\u6587\u65e8\u5728\u5206\u6790 Bean \u751f\u547d\u5468\u671f\u7684\u6574\u4f53\u6d41\u7a0b\uff0cBean \u5c31\u662f\u4e00\u4e9b Java \u5bf9\u8c61\uff0c\u53ea\u4e0d\u8fc7\u8fd9\u4e9b Bean \u4e0d\u662f\u6211\u4eec\u4e3b\u52a8 new \u51fa\u6765\u7684\uff0c\u800c\u662f\u4ea4\u4e2a Spring IOC \u5bb9\u5668\u521b\u5efa\u5e76\u7ba1\u7406\u7684\uff0c\u56e0\u6b64 Bean \u7684\u751f\u547d\u5468\u671f\u53d7 Spring IOC \u5bb9\u5668\u63a7\u5236\uff0cBean \u751f\u547d\u5468\u671f\u5927\u81f4\u5206\u4e3a\u4ee5\u4e0b\u51e0\u4e2a\u9636\u6bb5\uff1a"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"Bean \u7684\u5b9e\u4f8b\u5316(Instantiation) :"}),"\n",(0,r.jsx)(e.p,{children:"Spring \u6846\u67b6\u4f1a\u53d6\u51fa BeanDefinition \u7684\u4fe1\u606f\u8fdb\u884c\u5224\u65ad\u5f53\u524d Bean \u7684\u8303\u56f4\u662f\u5426\u662f singleton \u7684\uff0c\u662f\u5426\u4e0d\u662f\u5ef6\u8fdf\u52a0\u8f7d\u7684\uff0c\u662f\u5426\u4e0d\u662f FactoryBean \u7b49\uff0c\u6700\u7ec8\u5c06\u4e00\u4e2a\u666e\u901a\u7684 singleton \u7684 Bean \u901a\u8fc7\u53cd\u5c04\u8fdb\u884c\u5b9e\u4f8b\u5316"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:'Bean \u7684\u5c5e\u6027\u8d4b\u503c(Populate) :\nBean \u5b9e\u4f8b\u5316\u4e4b\u540e\u8fd8\u4ec5\u4ec5\u662f\u4e2a"\u534a\u6210\u54c1"\uff0c\u8fd8\u9700\u8981\u5bf9 Bean \u5b9e\u4f8b\u7684\u5c5e\u6027\u8fdb\u884c\u586b\u5145\uff0cBean \u7684\u5c5e\u6027\u8d4b\u503c\u5c31\u662f\u6307 Spring \u5bb9\u5668\u6839\u636e BeanDefinition \u4e2d\u5c5e\u6027\u914d\u7f6e\u7684\u5c5e\u6027\u503c\u6ce8\u5165\u5230 Bean \u5bf9\u8c61\u4e2d\u7684\u8fc7\u7a0b\u3002'}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"Bean \u7684\u521d\u59cb\u5316(Initialization) :\n\u5bf9 Bean \u5b9e\u4f8b\u7684\u5c5e\u6027\u8fdb\u884c\u586b\u5145\u5b8c\u4e4b\u540e\u8fd8\u9700\u8981\u6267\u884c\u4e00\u4e9b Aware \u63a5\u53e3\u65b9\u6cd5\u3001\u6267\u884c BeanPostProcessor \u65b9\u6cd5\u3001\u6267\u884c InitializingBean \u63a5\u53e3\u7684\u521d\u59cb\u5316\u65b9\u6cd5\u3001\u6267\u884c\u81ea\u5b9a\u4e49\u521d\u59cb\u5316 init \u65b9\u6cd5\u7b49\u3002\u8be5\u9636\u6bb5\u662f Spring \u6700\u5177\u6280\u672f\u542b\u91cf\u548c\u590d\u6742\u5ea6\u7684\u9636\u6bb5\uff0c\u5e76\u4e14 Spring \u9ad8\u9891\u9762\u8bd5\u9898 Bean \u7684\u5faa\u73af\u5f15\u7528\u95ee\u9898\u4e5f\u662f\u5728\u8fd9\u4e2a\u9636\u6bb5\u4f53\u73b0\u7684\uff1b"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"Bean \u7684\u4f7f\u7528\u9636\u6bb5:\n\u7ecf\u8fc7\u521d\u59cb\u5316\u9636\u6bb5\uff0cBean \u5c31\u6210\u4e3a\u4e86\u4e00\u4e2a\u5b8c\u6574\u7684 Spring Bean\uff0c\u88ab\u5b58\u50a8\u5230\u5355\u4f8b\u6c60 singletonObjects \u4e2d\u53bb\u4e86\uff0c\u5373\u5b8c\u6210\u4e86 Spring Bean \u7684\u6574\u4e2a\u751f\u547d\u5468\u671f\uff0c\u63a5\u4e0b\u6765 Bean \u5c31\u53ef\u4ee5\u88ab\u968f\u5fc3\u6240\u6b32\u5730\u4f7f\u7528\u4e86\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"Bean \u7684\u9500\u6bc1(Destruction) \uff1a\nBean \u7684\u9500\u6bc1\u662f\u6307 Spring \u5bb9\u5668\u5728\u5173\u95ed\u65f6\uff0c\u6267\u884c\u4e00\u4e9b\u6e05\u7406\u64cd\u4f5c\u7684\u8fc7\u7a0b\u3002\u5728 Spring \u5bb9\u5668\u4e2d\uff0c Bean \u7684\u9500\u6bc1\u65b9\u5f0f\u6709\u4e24\u79cd\uff1a\u9500\u6bc1\u65b9\u6cd5 destroy-method \u548c DisposableBean \u63a5\u53e3\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"2-\u751f\u547d\u5468\u671f\u63a5\u53e3\u65b9\u6cd5\u5206\u7c7b",children:"2. \u751f\u547d\u5468\u671f\u63a5\u53e3\u65b9\u6cd5\u5206\u7c7b"}),"\n",(0,r.jsx)(e.p,{children:"Bean \u7684\u5b8c\u6574\u751f\u547d\u5468\u671f\u7ecf\u5386\u4e86\u5404\u79cd\u65b9\u6cd5\u8c03\u7528\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u5212\u5206\u4e3a\u4ee5\u4e0b\u51e0\u7c7b\uff1a"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["Bean \u81ea\u8eab\u7684\u65b9\u6cd5:\n\u5305\u62ec\u4e86 Bean \u672c\u8eab\u8c03\u7528\u7684\u65b9\u6cd5\u548c\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u4e2d",(0,r.jsx)(e.code,{children:"<bean>"}),"\u7684 init-method \u548c destroy-method \u6307\u5b9a\u7684\u65b9\u6cd5"]}),"\n",(0,r.jsx)(e.li,{children:"Bean \u7ea7\u751f\u547d\u5468\u671f\u63a5\u53e3\u65b9\u6cd5:\n\u5305\u62ec\u4e86 BeanNameAware\u3001BeanFactoryAware\u3001InitializingBean \u548c DiposableBean \u8fd9\u4e9b\u63a5\u53e3\u7684\u65b9\u6cd5"}),"\n",(0,r.jsx)(e.li,{children:"\u5bb9\u5668\u7ea7\u751f\u547d\u5468\u671f\u63a5\u53e3\u65b9\u6cd5:\n\u5305\u62ec\u4e86 InstantiationAwareBeanPostProcessor \u548c BeanPostProcessor \u8fd9\u4e24\u4e2a\u63a5\u53e3\u5b9e\u73b0\uff0c\u4e00\u822c\u79f0\u5b83\u4eec\u7684\u5b9e\u73b0\u7c7b\u4e3a\u201c\u540e\u5904\u7406\u5668\u201d\u3002"}),"\n",(0,r.jsx)(e.li,{children:"\u5de5\u5382\u540e\u5904\u7406\u5668\u63a5\u53e3\u65b9\u6cd5:\n\u5305\u62ec\u4e86 AspectJWeavingEnabler, ConfigurationClassPostProcessor, CustomAutowireConfigurer \u7b49\u7b49\u975e\u5e38\u6709\u7528\u7684\u5de5\u5382\u540e\u5904\u7406\u5668\u3000\u3000\u63a5\u53e3\u7684\u65b9\u6cd5\u3002\u5de5\u5382\u540e\u5904\u7406\u5668\u4e5f\u662f\u5bb9\u5668\u7ea7\u7684\u3002\u5728\u5e94\u7528\u4e0a\u4e0b\u6587\u88c5\u914d\u914d\u7f6e\u6587\u4ef6\u4e4b\u540e\u7acb\u5373\u8c03\u7528\u3002"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"3-bean-\u751f\u547d\u5468\u671f",children:"3. Bean \u751f\u547d\u5468\u671f"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{alt:"bean\u521d\u59cb\u5316",src:t(2883).A+"",width:"1276",height:"1322"})}),"\n",(0,r.jsx)(e.h2,{id:"4-\u4ee3\u7801\u9a8c\u8bc1",children:"4. \u4ee3\u7801\u9a8c\u8bc1"}),"\n",(0,r.jsx)(e.h3,{id:"41-\u5f15\u5165\u4f9d\u8d56",children:"4.1 \u5f15\u5165\u4f9d\u8d56"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework</groupId>\n    <artifactId>spring-beans</artifactId>\n    <version>5.3.20</version>\n</dependency>\n<dependency>\n    <groupId>org.springframework</groupId>\n    <artifactId>spring-context</artifactId>\n    <version>5.3.20</version>\n</dependency>\n"})}),"\n",(0,r.jsx)(e.h3,{id:"42-bean-\u5b9a\u4e49",children:"4.2 Bean \u5b9a\u4e49"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.bean.lifecycle;\n\nimport org.springframework.beans.BeansException;\nimport org.springframework.beans.factory.BeanNameAware;\nimport org.springframework.beans.factory.DisposableBean;\nimport org.springframework.beans.factory.InitializingBean;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.ApplicationContextAware;\n\nimport javax.annotation.PostConstruct;\nimport javax.annotation.PreDestroy;\n\npublic class Person implements BeanNameAware, ApplicationContextAware, InitializingBean, DisposableBean {\n    private String name;\n\n    public Person() {\n        System.out.println("[\u6784\u9020\u5668]\u8c03\u7528Person\u7684\u6784\u9020\u5668\u5b9e\u4f8b\u5316");\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        System.out.println("[\u6ce8\u5165\u5c5e\u6027]\u6ce8\u5165\u5c5e\u6027name");\n        this.name = name;\n    }\n\n    @Override\n    public void setBeanName(String name) {\n        System.out.println("[BeanNameAware\u63a5\u53e3]\u8c03\u7528BeanNameAware#setBeanName");\n    }\n\n    @Override\n    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n        System.out.println("[ApplicationContextAware]\u8c03\u7528ApplicationContextAware#setApplicationContext");\n    }\n\n    @Override\n    public void afterPropertiesSet() throws Exception {\n        System.out.println("[InitializingBean\u63a5\u53e3]\u8c03\u7528InitializingBean#afterPropertiesSet");\n    }\n\n    @Override\n    public void destroy() throws Exception {\n        System.out.println("[DisposableBean\u63a5\u53e3]\u8c03\u7528DisposableBean#destroy");\n    }\n\n    @PostConstruct\n    public void postConstruct() {\n        System.out.println("[PostConstruct\u63a5\u53e3]\u8c03\u7528PostConstruct\u6ce8\u89e3\u7684\u65b9\u6cd5");\n    }\n\n    @PreDestroy\n    public void preDestroy() {\n        System.out.println("[PreDestroy\u63a5\u53e3]\u8c03\u7528\u4e86PreDestroy\u6ce8\u89e3\u7684\u65b9\u6cd5");\n    }\n\n    public void selfInit() {\n        System.out.println("[init-method]\u8c03\u7528<bean>\u7684init-method\u5c5e\u6027\u6307\u5b9a\u7684\u521d\u59cb\u5316\u65b9\u6cd5");\n    }\n\n    public void selfDestroy() {\n        System.out.println("[destroy-method]\u8c03\u7528<bean>\u7684destroy-method\u5c5e\u6027\u6307\u5b9a\u7684\u9500\u6bc1\u65b9\u6cd5");\n    }\n}\n\n'})}),"\n",(0,r.jsx)(e.h3,{id:"43-instantiationawarebeanpostprocessor-\u5b9a\u4e49",children:"4.3 InstantiationAwareBeanPostProcessor \u5b9a\u4e49"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.bean.lifecycle;\n\n\nimport org.springframework.beans.BeansException;\nimport org.springframework.beans.factory.config.InstantiationAwareBeanPostProcessor;\nimport org.springframework.stereotype.Component;\n\n@Component\npublic class MyInstantiationAwareBeanPostProcessor implements InstantiationAwareBeanPostProcessor {\n    @Override\n    public Object postProcessBeforeInstantiation(Class<?> BeanClass, String BeanName) throws BeansException {\n        System.out.println("[InstantiationAwareBeanPostProcessor\u63a5\u53e3]\u8c03\u7528InstantiationAwareBeanPostProcessor\u524d\u7f6e\u65b9\u6cd5, BeanName:" + BeanName);\n        return null;\n    }\n\n    @Override\n    public boolean postProcessAfterInstantiation(Object Bean, String BeanName) throws BeansException {\n        System.out.println("[InstantiationAwareBeanPostProcessor\u63a5\u53e3]\u8c03\u7528InstantiationAwareBeanPostProcessor\u540e\u7f6e\u65b9\u6cd5, BeanName:" + BeanName);\n        return false;\n    }\n}\n\n\n'})}),"\n",(0,r.jsx)(e.h3,{id:"44-beanpostprocessor-\u5b9a\u4e49",children:"4.4 BeanPostProcessor \u5b9a\u4e49"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.bean.lifecycle;\n\nimport org.springframework.beans.BeansException;\nimport org.springframework.beans.factory.config.BeanPostProcessor;\nimport org.springframework.stereotype.Component;\n\n@Component\npublic class MyBeanPostProcessor implements BeanPostProcessor {\n    @Override\n    public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {\n        System.out.println("[BeanPostProcessor\u63a5\u53e3]\u8c03\u7528\u4e86BeanPostProcessor\u7684\u524d\u7f6e\u5904\u7406\u65b9\u6cd5");\n        return bean;\n    }\n\n    @Override\n    public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {\n        System.out.println("[BeanPostProcessor\u63a5\u53e3]\u8c03\u7528\u4e86BeanPostProcessor\u7684\u540e\u7f6e\u5904\u7406\u65b9\u6cd5");\n        return bean;\n    }\n}\n\n'})}),"\n",(0,r.jsx)(e.h3,{id:"45-\u6d4b\u8bd5\u5165\u53e3",children:"4.5 \u6d4b\u8bd5\u5165\u53e3"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.bean.lifecycle;\n\nimport org.springframework.context.annotation.AnnotationConfigApplicationContext;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.ComponentScan;\nimport org.springframework.context.annotation.Configuration;\n\n@ComponentScan(basePackages = {"com.example.bean"})\n@Configuration\npublic class AppConfig {\n    @Bean(initMethod = "selfInit", destroyMethod = "selfDestroy")\n    public Person person() {\n        Person person = new Person();\n        person.setName("tester");\n        return person;\n    }\n\n    public static void main(String[] args) {\n        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);\n        context.close();\n    }\n}\n\n'})}),"\n",(0,r.jsx)(e.h3,{id:"46-\u6267\u884c\u7ed3\u679c",children:"4.6 \u6267\u884c\u7ed3\u679c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"[InstantiationAwareBeanPostProcessor\u63a5\u53e3]\u8c03\u7528InstantiationAwareBeanPostProcessor\u524d\u7f6e\u65b9\u6cd5, BeanName:person\n[\u6784\u9020\u5668]\u8c03\u7528Person\u7684\u6784\u9020\u5668\u5b9e\u4f8b\u5316\n[\u6ce8\u5165\u5c5e\u6027]\u6ce8\u5165\u5c5e\u6027name\n[InstantiationAwareBeanPostProcessor\u63a5\u53e3]\u8c03\u7528InstantiationAwareBeanPostProcessor\u540e\u7f6e\u65b9\u6cd5, BeanName:person\n\n[BeanNameAware\u63a5\u53e3]\u8c03\u7528BeanNameAware#setBeanName\n[ApplicationContextAware]\u8c03\u7528ApplicationContextAware#setApplicationContext\n[BeanPostProcessor\u63a5\u53e3]\u8c03\u7528\u4e86BeanPostProcessor\u7684\u524d\u7f6e\u5904\u7406\u65b9\u6cd5\n[PostConstruct\u63a5\u53e3]\u8c03\u7528PostConstruct\u6ce8\u89e3\u7684\u65b9\u6cd5\n[InitializingBean\u63a5\u53e3]\u8c03\u7528InitializingBean#afterPropertiesSet\n[init-method]\u8c03\u7528`<bean>`\u7684init-method\u5c5e\u6027\u6307\u5b9a\u7684\u521d\u59cb\u5316\u65b9\u6cd5\n[BeanPostProcessor\u63a5\u53e3]\u8c03\u7528\u4e86BeanPostProcessor\u7684\u540e\u7f6e\u5904\u7406\u65b9\u6cd5\n\n[PreDestroy\u63a5\u53e3]\u8c03\u7528\u4e86PreDestroy\u6ce8\u89e3\u7684\u65b9\u6cd5\n[DisposableBean\u63a5\u53e3]\u8c03\u7528DisposableBean#destroy\n[destroy-method]\u8c03\u7528`<bean>`\u7684destroy-method\u5c5e\u6027\u6307\u5b9a\u7684\u9500\u6bc1\u65b9\u6cd5\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u63a7\u5236\u53f0\u6253\u5370\u7ed3\u679c\u9a8c\u8bc1\u4e86 person \u5bf9\u8c61\u7684\u751f\u547d\u5468\u671f\u76f8\u5173\u65b9\u6cd5\u6267\u884c\u987a\u5e8f\u4e25\u683c\u9075\u4ece\u4e0a\u9762\u6d41\u7a0b\u56fe\uff0c\u540c\u65f6\u5f53\u6211\u4eec\u6267\u884c\u5bb9\u5668",(0,r.jsx)(e.code,{children:"applicationContext"}),"\u7684\u5173\u95ed\u65b9\u6cd5",(0,r.jsx)(e.code,{children:"close()"}),"\u4f1a\u89e6\u53d1\u8c03\u7528 bean \u7684\u9500\u6bc1\u56de\u8c03\u65b9\u6cd5"]}),"\n",(0,r.jsx)(e.h2,{id:"5lifecycle",children:"5.LifeCycle"}),"\n",(0,r.jsx)(e.h3,{id:"51-lifecycle",children:"5.1 Lifecycle"}),"\n",(0,r.jsx)(e.h4,{id:"511-\u4e3a\u4ec0\u4e48\u8981\u7528-lifecycle",children:"5.1.1 \u4e3a\u4ec0\u4e48\u8981\u7528 Lifecycle"}),"\n",(0,r.jsx)(e.p,{children:"\u5728 SpringBoot \u7684\u5e94\u7528\u4e2d\uff0c\u6211\u4eec\u901a\u5e38\u4f1a\u5229\u7528@PostConstruct \u548c@PreDestroy \u6ce8\u89e3\uff0c\u5728 Bean \u521d\u59cb\u5316\u6216\u9500\u6bc1\u65f6\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u90fd\u5904\u4e8e Bean \u58f0\u660e\u5468\u671f\u7684\u5c42\u9762\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u7136\u800c\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u9047\u5230\u4e00\u4e9b\u9057\u6f0f\u7684\u573a\u666f\uff0c\u6bd4\u5982\u5e0c\u671b\u5728\u5bb9\u5668\u672c\u8eab\u7684\u751f\u547d\u5468\u671f\u4e8b\u4ef6\uff08\u5982\u5bb9\u5668\u542f\u52a8\u3001\u505c\u6b62\uff09\u4e0a\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\uff0c\u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\u5c31\u662f\u5728 Spring Boot \u4e2d\u542f\u52a8\u5185\u5d4c\u7684 Web \u5bb9\u5668\u3002\u8fd9\u65f6\u5019\uff0c\u8be5\u5982\u4f55\u5904\u7406\u5462\uff1f"}),"\n",(0,r.jsxs)(e.p,{children:["\u8fd9\u5c31\u9700\u8981\u5229\u7528 Spring \u63d0\u4f9b\u7684\u53e6\u4e00\u4e2a\u63a5\u53e3 ",(0,r.jsx)(e.code,{children:"Lifecycle"}),"\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"Lifecycle"}),"\u63a5\u53e3\u5b83\u5141\u8bb8\u5728\u6240\u6709 Bean \u521b\u5efa\u5b8c\u6210\u4e4b\u540e\u6267\u884c\u81ea\u5b9a\u4e49\u7684\u4e00\u4e9b\u4efb\u52a1\u5e76\u8fd0\u884c\uff0c\u5e76\u5728\u9000\u51fa\u65f6\u6267\u884c\u8d44\u6e90\u9500\u6bc1\u6d41\u7a0b\u3002"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\u8fd9\u91cc\u662f\u6240\u6709 Bean \u521b\u5efa\u5b8c\u6210\u4e4b\u540e\u6267\u884c\uff0c\u5e76\u4e0d\u50cf\u6211\u4eec\u5e38\u4f1a\u7528\u5230\u7684",(0,r.jsx)(e.code,{children:"@PostConstruct"}),"\u548c",(0,r.jsx)(e.code,{children:"@PreDestroy"}),"\u4e24\u4e2a\u6ce8\u89e3\uff0c\u5b83\u4eec\u662f\u5728 Bean \u521d\u59cb\u5316\u6216\u9500\u6bc1\u65f6\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u5c5e\u4e8e Bean \u751f\u547d\u5468\u671f\u7ea7\u522b\uff1b"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"Lifecycle"}),"\u63a5\u53e3\u89e3\u51b3\u7684\u662f\u53e6\u5916\u4e00\u4e9b\u573a\u666f\uff0c\u6bd4\u5982\u6211\u4eec\u60f3\u5728",(0,r.jsx)(e.a,{href:"https://cloud.tencent.com/product/tke?from_column=20065&from=20065",children:"\u5bb9\u5668"}),"\u672c\u8eab\u7684\u751f\u547d\u5468\u671f\uff08\u6bd4\u5982\u5bb9\u5668\u542f\u52a8\u3001\u505c\u6b62\uff09\u7684\u4e8b\u4ef6\u4e0a\u505a\u4e00\u4e9b\u5de5\u4f5c"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"512-\u63a5\u53e3\u65b9\u6cd5",children:"5.1.2 \u63a5\u53e3\u65b9\u6cd5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"public interface Lifecycle {\n    /**\n     * \u5bb9\u5668\u542f\u52a8\u540e\u8c03\u7528\n     **/\n    void start();\n\n    /**\n     * \u5bb9\u5668\u505c\u6b62\u65f6\u8c03\u7528\n     **/\n    void stop();\n\n    /**\n     * \u68c0\u67e5\u6b64\u7ec4\u4ef6\u662f\u5426\u6b63\u5728\u8fd0\u884c\n     **/\n    boolean isRunning();\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u5f53",(0,r.jsx)(e.code,{children:"ApplicationContext"}),"\u63a5\u6536\u5230",(0,r.jsx)(e.code,{children:"start"}),"\u3001",(0,r.jsx)(e.code,{children:"stop"}),"\u548c",(0,r.jsx)(e.code,{children:"restart"}),"\u7b49\u4fe1\u53f7\u65f6\uff0c\u4f1a\u8c03\u7528\u5b9e\u73b0\u4e86",(0,r.jsx)(e.code,{children:"Lifecycle"}),"\u63a5\u53e3\u7684 Bean \u7684\u76f8\u5e94\u65b9\u6cd5\u3002\u901a\u8fc7\u5b9e\u73b0",(0,r.jsx)(e.code,{children:"Lifecycle"}),"\u63a5\u53e3\uff0c\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u5bf9\u5bb9\u5668\u751f\u547d\u5468\u671f\u7684\u56de\u8c03\uff0c\u4ece\u800c\u5b9e\u73b0\u4e1a\u52a1\u6269\u5c55\u3002"]}),"\n",(0,r.jsx)(e.h4,{id:"513-\u4ee3\u7801\u793a\u4f8b",children:"5.1.3 \u4ee3\u7801\u793a\u4f8b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.bean.lifecycle;\n\nimport org.springframework.beans.BeansException;\nimport org.springframework.beans.factory.BeanNameAware;\nimport org.springframework.beans.factory.DisposableBean;\nimport org.springframework.beans.factory.InitializingBean;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.ApplicationContextAware;\nimport org.springframework.context.Lifecycle;\nimport org.springframework.context.SmartLifecycle;\n\nimport javax.annotation.PostConstruct;\nimport javax.annotation.PreDestroy;\n\n\npublic class Person implements BeanNameAware, ApplicationContextAware, InitializingBean, DisposableBean, Lifecycle {\n    private String name;\n\n    private volatile boolean running = false;\n\n    public Person() {\n        System.out.println("[\u6784\u9020\u5668]\u8c03\u7528Person\u7684\u6784\u9020\u5668\u5b9e\u4f8b\u5316");\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        System.out.println("[\u6ce8\u5165\u5c5e\u6027]\u6ce8\u5165\u5c5e\u6027name");\n        this.name = name;\n    }\n\n    @Override\n    public void setBeanName(String name) {\n        System.out.println("[BeanNameAware\u63a5\u53e3]\u8c03\u7528BeanNameAware#setBeanName");\n    }\n\n    @Override\n    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n        System.out.println("[ApplicationContextAware]\u8c03\u7528ApplicationContextAware#setApplicationContext");\n    }\n\n    @Override\n    public void afterPropertiesSet() throws Exception {\n        System.out.println("[InitializingBean\u63a5\u53e3]\u8c03\u7528InitializingBean#afterPropertiesSet");\n    }\n\n    @Override\n    public void destroy() throws Exception {\n        System.out.println("[DisposableBean\u63a5\u53e3]\u8c03\u7528DisposableBean#destroy");\n    }\n\n    @PostConstruct\n    public void postConstruct() {\n        System.out.println("[PostConstruct\u63a5\u53e3]\u8c03\u7528PostConstruct\u6ce8\u89e3\u7684\u65b9\u6cd5");\n    }\n\n    @PreDestroy\n    public void preDestroy() {\n        System.out.println("[PreDestroy\u63a5\u53e3]\u8c03\u7528\u4e86PreDestroy\u6ce8\u89e3\u7684\u65b9\u6cd5");\n    }\n\n    public void selfInit() {\n        System.out.println("[init-method]\u8c03\u7528<bean>\u7684init-method\u5c5e\u6027\u6307\u5b9a\u7684\u521d\u59cb\u5316\u65b9\u6cd5");\n    }\n\n    public void selfDestroy() {\n        System.out.println("[destroy-method]\u8c03\u7528<bean>\u7684destroy-method\u5c5e\u6027\u6307\u5b9a\u7684\u9500\u6bc1\u65b9\u6cd5");\n    }\n\n\n    /**\n     * \u5bb9\u5668\u542f\u52a8\u540e\u8c03\u7528\n     */\n    @Override\n    public void start() {\n        System.out.println("\u6536\u5230\u5bb9\u5668\u542f\u52a8\u7684\u4fe1\u53f7\u540e\uff0c\u6267\u884cLifecycle#start");\n        running = true;\n    }\n\n\n    /**\n     * \u5bb9\u5668\u505c\u6b62\u65f6\u8c03\u7528\n     */\n    @Override\n    public void stop() {\n        System.out.println("\u6536\u5230\u5173\u95ed\u5bb9\u5668\u7684\u4fe1\u53f7\u540e\uff0c\u6267\u884cLifecycle#stop");\n        running = false;\n    }\n\n    /**\n     * \u68c0\u67e5\u6b64\u7ec4\u4ef6\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002\n     * 1. \u53ea\u6709\u8be5\u65b9\u6cd5\u8fd4\u56defalse\u65f6\uff0cstart()\u65b9\u6cd5\u624d\u4f1a\u88ab\u6267\u884c\uff0c\u5bb9\u5668\u542f\u52a8\u540e\u3002\n     * 2. \u53ea\u6709\u8be5\u65b9\u6cd5\u8fd4\u56detrue\u65f6\uff0cstop()\u65b9\u6cd5\u624d\u4f1a\u88ab\u6267\u884c\uff0c\u5bb9\u5668\u505c\u6b62\u65f6\u3002\n     */\n    @Override\n    public boolean isRunning() {\n        System.out.println("\u68c0\u67e5Lifecycle\u7ec4\u4ef6\u7684\u8fd0\u884c\u72b6\u6001:" + running);\n        return running;\n    }\n\n}\n\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.bean.lifecycle;\n\nimport org.springframework.context.annotation.AnnotationConfigApplicationContext;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.ComponentScan;\nimport org.springframework.context.annotation.Configuration;\n\n@ComponentScan(basePackages = {"com.example.bean"})\n@Configuration\npublic class AppConfig {\n    @Bean(initMethod = "selfInit", destroyMethod = "selfDestroy")\n    public Person person() {\n        Person person = new Person();\n        person.setName("tester");\n        return person;\n    }\n\n    public static void main(String[] args) {\n        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);\n        context.start();\n        System.out.println("\u5bb9\u5668\u542f\u52a8....");\n        context.close();\n    }\n}\n\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u6267\u884c\u7ed3\u679c:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:"[InstantiationAwareBeanPostProcessor\u63a5\u53e3]\u8c03\u7528InstantiationAwareBeanPostProcessor\u524d\u7f6e\u65b9\u6cd5, BeanName:person\n[\u6784\u9020\u5668]\u8c03\u7528Person\u7684\u6784\u9020\u5668\u5b9e\u4f8b\u5316\n[\u6ce8\u5165\u5c5e\u6027]\u6ce8\u5165\u5c5e\u6027name\n[InstantiationAwareBeanPostProcessor\u63a5\u53e3]\u8c03\u7528InstantiationAwareBeanPostProcessor\u540e\u7f6e\u65b9\u6cd5, BeanName:person\n[BeanNameAware\u63a5\u53e3]\u8c03\u7528BeanNameAware#setBeanName\n[ApplicationContextAware]\u8c03\u7528ApplicationContextAware#setApplicationContext\n[BeanPostProcessor\u63a5\u53e3]\u8c03\u7528\u4e86BeanPostProcessor\u7684\u524d\u7f6e\u5904\u7406\u65b9\u6cd5\n[PostConstruct\u63a5\u53e3]\u8c03\u7528PostConstruct\u6ce8\u89e3\u7684\u65b9\u6cd5\n[InitializingBean\u63a5\u53e3]\u8c03\u7528InitializingBean#afterPropertiesSet\n[init-method]\u8c03\u7528<bean>\u7684init-method\u5c5e\u6027\u6307\u5b9a\u7684\u521d\u59cb\u5316\u65b9\u6cd5\n[BeanPostProcessor\u63a5\u53e3]\u8c03\u7528\u4e86BeanPostProcessor\u7684\u540e\u7f6e\u5904\u7406\u65b9\u6cd5\n\u68c0\u67e5Lifecycle\u7ec4\u4ef6\u7684\u8fd0\u884c\u72b6\u6001:false\n\u6536\u5230\u5bb9\u5668\u542f\u52a8\u7684\u4fe1\u53f7\u540e\uff0c\u6267\u884cLifecycle#start\n\u5bb9\u5668\u542f\u52a8....\n\u68c0\u67e5Lifecycle\u7ec4\u4ef6\u7684\u8fd0\u884c\u72b6\u6001:true\n\u6536\u5230\u5173\u95ed\u5bb9\u5668\u7684\u4fe1\u53f7\u540e\uff0c\u6267\u884cLifecycle#stop\n[PreDestroy\u63a5\u53e3]\u8c03\u7528\u4e86PreDestroy\u6ce8\u89e3\u7684\u65b9\u6cd5\n[DisposableBean\u63a5\u53e3]\u8c03\u7528DisposableBean#destroy\n[destroy-method]\u8c03\u7528<bean>\u7684destroy-method\u5c5e\u6027\u6307\u5b9a\u7684\u9500\u6bc1\u65b9\u6cd5\n\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u9700\u8981\u6ce8\u610f\u7684\u662f\u5728",(0,r.jsx)(e.code,{children:"SpringBoot"}),"\u6216",(0,r.jsx)(e.code,{children:"Spring"}),"\u5e94\u7528\u4e2d\uff0c**\u5982\u679c\u53ea\u662f\u5b9e\u73b0\u4e86 ",(0,r.jsx)(e.code,{children:"Lifecycle"})," \u63a5\u53e3\u800c\u6ca1\u6709\u663e\u5f0f\u8c03\u7528 AbstractApplicationContext \u7684 start()\u65b9\u6cd5\uff0c\u90a3\u4e48",(0,r.jsx)(e.code,{children:"Lifecycle#start()"}),"\u65b9\u6cd5",(0,r.jsx)(e.code,{children:"Lifecycle#isRunning()"}),"\u65b9\u6cd5\u4e0d\u4f1a\u88ab\u6267\u884c\u3002**\u7136\u800c\uff0c\u5728\u5e94\u7528\u9000\u51fa\u65f6\uff0c\u4f1a\u6267\u884c",(0,r.jsx)(e.code,{children:"Lifecycle#isRunning()"}),"\u65b9\u6cd5\u6765\u5224\u65ad\u8be5",(0,r.jsx)(e.code,{children:"Lifecycle"}),"\u662f\u5426\u5df2\u7ecf\u542f\u52a8\uff0c\u5982\u679c\u8fd4\u56de true\uff0c\u5219\u4f1a\u8c03\u7528",(0,r.jsx)(e.code,{children:"Lifecycle#stop()"}),"\u65b9\u6cd5\u6765\u505c\u6b62\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:["\u8fd9\u79cd\u5b9e\u73b0\u65b9\u5f0f\u9700\u8981\u4f7f\u7528\u8005\u663e\u5f0f\u5730\u8c03\u7528\u5bb9\u5668\u7684",(0,r.jsx)(e.code,{children:"start()"}),"\u548c",(0,r.jsx)(e.code,{children:"stop()"}),"\u65b9\u6cd5\u624d\u80fd\u89e6\u53d1",(0,r.jsx)(e.code,{children:"Lifecycle"}),"\u63a5\u53e3\u7684\u65b9\u6cd5\u6267\u884c\uff0c\u800c\u5728\u4e00\u822c\u7684\u9879\u76ee\u4e2d\uff0c\u6211\u4eec\u5f88\u5c11\u8fd9\u6837\u663e\u5f0f\u7684\u53bb\u8c03\u7528\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c",(0,r.jsx)(e.code,{children:"Spring"}),"\u63d0\u4f9b\u4e86",(0,r.jsx)(e.code,{children:"SmartLifecycle"}),"\u63a5\u53e3\u3002"]}),"\n",(0,r.jsx)(e.h3,{id:"52-smartlifecycle",children:"5.2 SmartLifecycle"}),"\n",(0,r.jsx)(e.h4,{id:"521-\u4e3a\u4ec0\u4e48\u8981\u7528-smartlifecycle",children:"5.2.1 \u4e3a\u4ec0\u4e48\u8981\u7528 SmartLifecycle"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"SmartLifecycle"}),"\u7ee7\u627f\u4e86",(0,r.jsx)(e.code,{children:"Lifecycle"}),"\u63a5\u53e3\uff0c\u5e76\u4e14\u63d0\u4f9b\u4e86\u66f4\u667a\u80fd\u7684\u529f\u80fd\uff1a"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\u5b9e\u73b0",(0,r.jsx)(e.code,{children:"SmartLifecycle"}),"\u63a5\u53e3\u7684\u7ec4\u4ef6\u53ef\u4ee5\u81ea\u52a8\u542f\u52a8\u548c\u505c\u6b62\uff1b"]}),"\n",(0,r.jsx)(e.li,{children:"\u53ef\u4ee5\u63a7\u5236\u591a\u4e2a\u7ec4\u4ef6\u7684\u6267\u884c\u987a\u5e8f\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["\u5728\u5e94\u7528\u542f\u52a8\u65f6\uff0c\u4f1a\u81ea\u52a8\u8c03\u7528\u5b9e\u73b0\u4e86",(0,r.jsx)(e.code,{children:"SmartLifecycle"}),"\u63a5\u53e3\u7684\u7ec4\u4ef6\u7684",(0,r.jsx)(e.code,{children:"start()"}),"\u65b9\u6cd5\uff0c\u800c\u65e0\u9700\u663e\u5f0f\u8c03\u7528\u5bb9\u5668\u7684",(0,r.jsx)(e.code,{children:"start()"}),"\u65b9\u6cd5\u3002\u56e0\u6b64\uff0c\u5982\u679c\u5e0c\u671b\u7ec4\u4ef6\u7684\u751f\u547d\u5468\u671f\u65b9\u6cd5\u80fd\u591f\u81ea\u52a8\u6267\u884c\u800c\u65e0\u9700\u663e\u5f0f\u8c03\u7528\u5bb9\u5668\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u8003\u8651\u5b9e\u73b0",(0,r.jsx)(e.code,{children:"SmartLifecycle"}),"\u63a5\u53e3\u800c\u4e0d\u662f\u4ec5\u4ec5\u5b9e\u73b0",(0,r.jsx)(e.code,{children:"Lifecycle"}),"\u63a5\u53e3\u3002"]}),"\n",(0,r.jsx)(e.h4,{id:"522-\u63a5\u53e3\u65b9\u6cd5",children:"5.2.2 \u63a5\u53e3\u65b9\u6cd5"}),"\n",(0,r.jsx)(e.p,{children:"isAutoStartup()\uff1a\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u6307\u793a\u8fd9\u4e2a\u751f\u547d\u5468\u671f\u7ec4\u4ef6\u662f\u5426\u5e94\u8be5\u5728 Spring \u5bb9\u5668\u542f\u52a8\u65f6\u81ea\u52a8\u542f\u52a8\u3002\ngetPhase()\uff1a\u8fd4\u56de\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a\u8fd9\u4e2a\u751f\u547d\u5468\u671f\u7ec4\u4ef6\u7684\u542f\u52a8\u987a\u5e8f\u3002\u6570\u503c\u8d8a\u5c0f\uff0c\u7ec4\u4ef6\u542f\u52a8\u7684\u8d8a\u65e9\u3002\nstart()\uff1a\u542f\u52a8\u8fd9\u4e2a\u751f\u547d\u5468\u671f\u7ec4\u4ef6\u3002\nstop()\uff1a\u505c\u6b62\u8fd9\u4e2a\u751f\u547d\u5468\u671f\u7ec4\u4ef6\u3002\nstop(Runnable callback)\uff1a\u505c\u6b62\u751f\u547d\u5468\u671f\u7ec4\u4ef6\uff0c\u5e76\u5728\u505c\u6b62\u540e\u6267\u884c\u63d0\u4f9b\u7684\u56de\u8c03\u3002"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u7684\u667a\u80fd\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u5141\u8bb8\u591a\u4e2a\u7ec4\u4ef6\u6839\u636e getPhase() \u65b9\u6cd5\u8fd4\u56de\u7684\u503c\u81ea\u52a8\u6392\u5e8f\uff0c\u786e\u4fdd\u5b83\u4eec\u6309\u7167\u6b63\u786e\u7684\u987a\u5e8f\u542f\u52a8\u548c\u505c\u6b62\u3002\u8fd9\u5bf9\u4e8e\u9700\u8981\u4f9d\u8d56\u5176\u4ed6\u7ec4\u4ef6\u542f\u52a8\u540e\u518d\u542f\u52a8\u7684\u573a\u666f\u975e\u5e38\u6709\u7528\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:["\u4f8b\u5982\uff0c\u5728 Spring Boot \u5e94\u7528\u4e2d\uff0c\u4f60\u53ef\u80fd\u4f1a\u6709\u4e00\u4e9b\u7ec4\u4ef6\u9700\u8981\u5728\u6570\u636e\u5e93\u8fde\u63a5\u5efa\u7acb\u4e4b\u540e\u624d\u80fd\u542f\u52a8\uff0c\u6216\u8005\u9700\u8981\u5728\u67d0\u4e9b\u670d\u52a1\u6ce8\u518c\u5230 Eureka \u670d\u52a1\u5668\u4e4b\u540e\u624d\u80fd\u542f\u52a8\u3002\u901a\u8fc7\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:"SmartLifecycle"}),"\uff0c\u4f60\u53ef\u4ee5\u786e\u4fdd\u8fd9\u4e9b\u7ec4\u4ef6\u5728\u4f9d\u8d56\u6761\u4ef6\u6ee1\u8db3\u540e\u6309\u6b63\u786e\u7684\u987a\u5e8f\u542f\u52a8\u3002"]}),"\n",(0,r.jsx)(e.h4,{id:"523-\u4f7f\u7528\u573a\u666f",children:"5.2.3 \u4f7f\u7528\u573a\u666f"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u5f02\u6b65\u521d\u59cb\u5316\u6216\u9500\u6bc1\u64cd\u4f5c:"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u63a5\u53e3\u5141\u8bb8\u5728\u5bb9\u5668\u542f\u52a8\u6216\u5173\u95ed\u8fc7\u7a0b\u4e2d\u6267\u884c\u5f02\u6b65\u64cd\u4f5c\u3002\u8fd9\u5bf9\u4e8e\u9700\u8981\u5728\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u6216\u5173\u95ed\u65f6\u6267\u884c\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u4efb\u52a1\u6216\u8d44\u6e90\u6e05\u7406\u64cd\u4f5c\u975e\u5e38\u6709\u7528\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u6709\u5e8f\u542f\u52a8\u548c\u5173\u95ed\uff1a"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"SmartLifecycle "})," \u53ef\u4ee5\u6307\u5b9a\u7ec4\u4ef6\u7684\u542f\u52a8\u548c\u5173\u95ed\u987a\u5e8f\uff0c\u786e\u4fdd\u5728\u542f\u52a8\u6216\u5173\u95ed\u8fc7\u7a0b\u4e2d\u5176\u4ed6\u7ec4\u4ef6\u5df2\u7ecf\u51c6\u5907\u597d\u6216\u8005\u5df2\u7ecf\u5b8c\u6210\u3002\u5f53\u4f60\u7684\u7ec4\u4ef6\u5728\u542f\u52a8\u7684\u65f6\u5019\uff0c\u6709\u4f9d\u8d56\u5173\u7cfb\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5 ",(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u6765\u8fdb\u884c\u63a7\u5236\u7ec4\u4ef6\u7684\u542f\u52a8\u987a\u5e8f\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u52a8\u6001\u51b3\u5b9a\u542f\u52a8\u548c\u5173\u95ed\uff1a"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u63a5\u53e3\u4e2d\u7684\u65b9\u6cd5\u80fd\u591f\u8ba9\u7ec4\u4ef6\u52a8\u6001\u5730\u51b3\u5b9a\u4f55\u65f6\u542f\u52a8\u6216\u5173\u95ed\u3002\u8fd9\u4f7f\u5f97\u5728\u7279\u5b9a\u6761\u4ef6\u6ee1\u8db3\u65f6\u624d\u542f\u52a8\u6216\u5173\u95ed\u7ec4\u4ef6\u6210\u4e3a\u53ef\u80fd\uff0c\u4ece\u800c\u63d0\u9ad8\u4e86\u7cfb\u7edf\u7684\u7075\u6d3b\u6027\u548c\u53ef\u63a7\u6027\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u72b6\u6001\u7ba1\u7406\uff1a"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u63a5\u53e3\u63d0\u4f9b\u4e86\u65b9\u6cd5\u6765\u67e5\u8be2\u7ec4\u4ef6\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4f8b\u5982\u662f\u5426\u5df2\u7ecf\u542f\u52a8\u6216\u505c\u6b62\u3002\u8fd9\u5bf9\u4e8e\u5728\u5e94\u7528\u7a0b\u5e8f\u7684\u5176\u4ed6\u90e8\u5206\u4e2d\u6839\u636e\u7ec4\u4ef6\u72b6\u6001\u505a\u51fa\u51b3\u7b56\u6216\u6267\u884c\u7279\u5b9a\u7684\u903b\u8f91\u975e\u5e38\u6709\u7528\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u8d44\u6e90\u76d1\u63a7\u5668\u7684\u542f\u52a8\u548c\u505c\u6b62\uff1a"}),"\n",(0,r.jsxs)(e.p,{children:["\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5b58\u5728\u8d44\u6e90\u76d1\u63a7\u5668\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u63a5\u53e3\u6765\u542f\u52a8\u548c\u505c\u6b62\u8fd9\u4e9b\u76d1\u63a7\u5668\u3002\u5728\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u76d1\u63a7\u5668\u53ef\u4ee5\u5f00\u59cb\u76d1\u63a7\u8d44\u6e90\u7684\u4f7f\u7528\u60c5\u51b5\u3002\u5728\u5e94\u7528\u7a0b\u5e8f\u5173\u95ed\u65f6\uff0c\u53ef\u4ee5\u505c\u6b62\u76d1\u63a7\u5668\u5e76\u91ca\u653e\u8d44\u6e90\u3002"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5177\u4f53\u7684 ",(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u63a5\u53e3\u7684\u5e94\u7528\u573a\u666f\uff1a"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u7ba1\u7406\uff1a"}),"\n",(0,r.jsxs)(e.p,{children:["\u5728\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u53ef\u4ee5\u5229\u7528 ",(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u63a5\u53e3\u6765\u521d\u59cb\u5316\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3002\u5728\u5e94\u7528\u7a0b\u5e8f\u5173\u95ed\u65f6\uff0c\u53ef\u4ee5\u5229\u7528 ",(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u63a5\u53e3\u6765\u4f18\u96c5\u5730\u5173\u95ed\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff0c\u786e\u4fdd\u6240\u6709\u6570\u636e\u5e93\u8fde\u63a5\u90fd\u5df2\u91ca\u653e\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u7f13\u5b58\u7684\u521d\u59cb\u5316\u548c\u9500\u6bc1\uff1a"}),"\n",(0,r.jsxs)(e.p,{children:["\u5728\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u63a5\u53e3\u6765\u521d\u59cb\u5316\u7f13\u5b58\u5e76\u52a0\u8f7d\u6570\u636e\u3002\u5728\u5e94\u7528\u7a0b\u5e8f\u5173\u95ed\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u63a5\u53e3\u6765\u4f18\u96c5\u5730\u9500\u6bc1\u7f13\u5b58\u5e76\u91ca\u653e\u8d44\u6e90\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u5b9a\u65f6\u4efb\u52a1\u7684\u7ba1\u7406\uff1a"}),"\n",(0,r.jsxs)(e.p,{children:["\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5b58\u5728\u5b9a\u65f6\u4efb\u52a1\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u63a5\u53e3\u6765\u542f\u52a8\u548c\u5173\u95ed\u8fd9\u4e9b\u5b9a\u65f6\u4efb\u52a1\u3002\u5728\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u5b9a\u65f6\u4efb\u52a1\u53ef\u4ee5\u6ce8\u518c\u5e76\u5f00\u59cb\u6267\u884c\u3002\u5728\u5e94\u7528\u7a0b\u5e8f\u5173\u95ed\u65f6\uff0c\u53ef\u4ee5\u4f18\u96c5\u5730\u505c\u6b62\u5b9a\u65f6\u4efb\u52a1\u7684\u6267\u884c\u3002"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"524-\u4ee3\u7801\u793a\u4f8b",children:"5.2.4 \u4ee3\u7801\u793a\u4f8b"}),"\n",(0,r.jsxs)(e.p,{children:["\u4fee\u6539 Person, \u5b9e\u73b0 ",(0,r.jsx)(e.code,{children:"SmartLifecycle"})," \u63a5\u53e3:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.bean.lifecycle;\n\nimport org.springframework.beans.BeansException;\nimport org.springframework.beans.factory.BeanNameAware;\nimport org.springframework.beans.factory.DisposableBean;\nimport org.springframework.beans.factory.InitializingBean;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.ApplicationContextAware;\nimport org.springframework.context.Lifecycle;\nimport org.springframework.context.`SmartLifecycle `;\n\nimport javax.annotation.PostConstruct;\nimport javax.annotation.PreDestroy;\n\n\npublic class Person implements BeanNameAware, ApplicationContextAware, InitializingBean, DisposableBean, SmartLifecycle {\n    private String name;\n\n    private volatile boolean running = false;\n\n    public Person() {\n        System.out.println("[\u6784\u9020\u5668]\u8c03\u7528Person\u7684\u6784\u9020\u5668\u5b9e\u4f8b\u5316");\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        System.out.println("[\u6ce8\u5165\u5c5e\u6027]\u6ce8\u5165\u5c5e\u6027name");\n        this.name = name;\n    }\n\n    @Override\n    public void setBeanName(String name) {\n        System.out.println("[BeanNameAware\u63a5\u53e3]\u8c03\u7528BeanNameAware#setBeanName");\n    }\n\n    @Override\n    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n        System.out.println("[ApplicationContextAware]\u8c03\u7528ApplicationContextAware#setApplicationContext");\n    }\n\n    @Override\n    public void afterPropertiesSet() throws Exception {\n        System.out.println("[InitializingBean\u63a5\u53e3]\u8c03\u7528InitializingBean#afterPropertiesSet");\n    }\n\n    @Override\n    public void destroy() throws Exception {\n        System.out.println("[DisposableBean\u63a5\u53e3]\u8c03\u7528DisposableBean#destroy");\n    }\n\n    @PostConstruct\n    public void postConstruct() {\n        System.out.println("[PostConstruct\u63a5\u53e3]\u8c03\u7528PostConstruct\u6ce8\u89e3\u7684\u65b9\u6cd5");\n    }\n\n    @PreDestroy\n    public void preDestroy() {\n        System.out.println("[PreDestroy\u63a5\u53e3]\u8c03\u7528\u4e86PreDestroy\u6ce8\u89e3\u7684\u65b9\u6cd5");\n    }\n\n    public void selfInit() {\n        System.out.println("[init-method]\u8c03\u7528<bean>\u7684init-method\u5c5e\u6027\u6307\u5b9a\u7684\u521d\u59cb\u5316\u65b9\u6cd5");\n    }\n\n    public void selfDestroy() {\n        System.out.println("[destroy-method]\u8c03\u7528<bean>\u7684destroy-method\u5c5e\u6027\u6307\u5b9a\u7684\u9500\u6bc1\u65b9\u6cd5");\n    }\n\n    /**\n     * 1. \u4e3b\u8981\u5728\u8be5\u65b9\u6cd5\u4e2d\u542f\u52a8\u4efb\u52a1\u6216\u8005\u5176\u4ed6\u5f02\u6b65\u670d\u52a1\uff0c\u6bd4\u5982\u5f00\u542fMQ\u63a5\u6536\u6d88\u606f<br/>\n     * 2. \u5f53\u4e0a\u4e0b\u6587\u88ab\u5237\u65b0\uff08\u6240\u6709\u5bf9\u8c61\u5df2\u88ab\u5b9e\u4f8b\u5316\u548c\u521d\u59cb\u5316\u4e4b\u540e\uff09\u65f6\uff0c\u5c06\u8c03\u7528\u8be5\u65b9\u6cd5\uff0c\n     * \u9ed8\u8ba4\u751f\u547d\u5468\u671f\u5904\u7406\u5668\u5c06\u68c0\u67e5\u6bcf\u4e2aSmartLifecycle\u5bf9\u8c61\u7684isAutoStartup()\u65b9\u6cd5\u8fd4\u56de\u7684\u5e03\u5c14\u503c\u3002\n     * \u5982\u679c\u4e3a\u201ctrue\u201d\uff0c\u5219\u8be5\u65b9\u6cd5\u4f1a\u88ab\u8c03\u7528\uff0c\u800c\u4e0d\u662f\u7b49\u5f85\u663e\u5f0f\u8c03\u7528\u81ea\u5df1\u7684start()\u65b9\u6cd5\u3002\n     */\n    @Override\n    public void start() {\n        System.out.println("[SmartLifecycle]start\u65b9\u6cd5\u8c03\u7528, \u542f\u52a8\u5b8c\u6210");\n        running = true;\n    }\n\n    /**\n     * SmartLifecycle\u5b50\u7c7b\u7684\u624d\u6709\u7684\u65b9\u6cd5\uff0c\u5f53isRunning\u65b9\u6cd5\u8fd4\u56detrue\u65f6\uff0c\u8be5\u65b9\u6cd5\u624d\u4f1a\u88ab\u8c03\u7528\u3002\n     * \u5f88\u591a\u6846\u67b6\u4e2d\u7684\u6e90\u7801\u4e2d\uff0c\u90fd\u4f1a\u628a\u771f\u6b63\u903b\u8f91\u5199\u5728stop()\u65b9\u6cd5\u5185\u3002\n     * \u6bd4\u5982quartz\u548cRedis\u7684spring\u652f\u6301\u5305\u3002\n     */\n    @Override\n    public void stop(Runnable callback) {\n        System.out.println("[SmartLifecycle]stop\u65b9\u6cd5\u8c03\u7528, \u6267\u884c\u56de\u8c03\u51fd\u6570");\n        stop();\n        // \u5982\u679c\u4f60\u8ba9isRunning\u8fd4\u56detrue\uff0c\u9700\u8981\u6267\u884cstop\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u90a3\u4e48\u5c31\u4e0d\u8981\u5fd8\u8bb0\u8c03\u7528callback.run()\u3002\n        // \u5426\u5219\u5728\u7a0b\u5e8f\u9000\u51fa\u65f6\uff0cSpring\u7684DefaultLifecycleProcessor\u4f1a\u8ba4\u4e3a\u8fd9\u4e2aMySmartLifecycle\u6ca1\u6709stop\u5b8c\u6210\uff0c\u7a0b\u5e8f\u4f1a\u4e00\u76f4\u5361\u7740\u7ed3\u675f\u4e0d\u4e86\uff0c\u7b49\u5f85\u4e00\u5b9a\u65f6\u95f4\uff08\u9ed8\u8ba4\u8d85\u65f6\u65f6\u95f430\u79d2\uff09\u540e\u624d\u4f1a\u81ea\u52a8\u7ed3\u675f\u3002\n        callback.run();\n    }\n\n    /**\n     * \u63a5\u53e3Lifecycle\u5b50\u7c7b\u7684\u65b9\u6cd5\uff0c\u53ea\u6709\u975eSmartLifecycle\u7684\u5b50\u7c7b\u624d\u4f1a\u6267\u884c\u8be5\u65b9\u6cd5\u3002<br/>\n     * 1. \u8be5\u65b9\u6cd5\u53ea\u5bf9\u76f4\u63a5\u5b9e\u73b0\u63a5\u53e3Lifecycle\u7684\u7c7b\u624d\u8d77\u4f5c\u7528\uff0c\u5bf9\u5b9e\u73b0SmartLifecycle\u63a5\u53e3\u7684\u7c7b\u65e0\u6548\u3002<br/>\n     * 2. \u65b9\u6cd5stop()\u548c\u65b9\u6cd5stop(Runnable callback)\u7684\u533a\u522b\u53ea\u5728\u4e8e\uff0c\u540e\u8005\u662fSmartLifecycle\u5b50\u7c7b\u7684\u4e13\u5c5e\u3002\n     */\n    @Override\n    public void stop() {\n        System.out.println("[SmartLifecycle]stop\u65b9\u6cd5\u8c03\u7528, running: " + running);\n        running = false;\n    }\n\n    /**\n     * 1. \u53ea\u6709\u8be5\u65b9\u6cd5\u8fd4\u56defalse\u65f6\uff0cstart\u65b9\u6cd5\u624d\u4f1a\u88ab\u6267\u884c\u3002<br/>\n     * 2. \u53ea\u6709\u8be5\u65b9\u6cd5\u8fd4\u56detrue\u65f6\uff0cstop(Runnable callback)\u6216stop()\u65b9\u6cd5\u624d\u4f1a\u88ab\u6267\u884c\u3002\n     */\n    @Override\n    public boolean isRunning() {\n        System.out.println("[SmartLifecycle]isRunning\u65b9\u6cd5\u8c03\u7528, running: " + running);\n        return running;\n    }\n\n    /**\n     * \u5982\u679c\u8be5`Lifecycle`\u7c7b\u6240\u5728\u7684\u4e0a\u4e0b\u6587\u5728\u8c03\u7528`refresh`\u65f6,\u5e0c\u671b\u80fd\u591f\u81ea\u5df1\u81ea\u52a8\u8fdb\u884c\u56de\u8c03\uff0c\u5219\u8fd4\u56de`true`,\n     * false\u7684\u503c\u8868\u660e\u7ec4\u4ef6\u6253\u7b97\u901a\u8fc7\u663e\u5f0f\u7684start()\u8c03\u7528\u6765\u542f\u52a8\uff0c\u7c7b\u4f3c\u4e8e\u666e\u901a\u7684Lifecycle\u5b9e\u73b0\u3002\n     * \u9ed8\u8ba4\u5c31\u662ftrue\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e0d\u7528\u91cd\u5199\u6b64\u65b9\u6cd5\u3002\n     */\n    @Override\n    public boolean isAutoStartup() {\n        return false;\n    }\n\n    /**\n     * \u5982\u679c\u6709\u591a\u4e2a\u5b9e\u73b0\u63a5\u53e3SmartLifecycle\u7684\u7c7b\uff0c\u5219\u8fd9\u4e9b\u7c7b\u7684start\u7684\u6267\u884c\u987a\u5e8f\u6309getPhase\u65b9\u6cd5\u8fd4\u56de\u503c\u4ece\u5c0f\u5230\u5927\u6267\u884c\u3002<br/>\n     * \u4f8b\u5982\uff1a1\u6bd42\u5148\u6267\u884c\uff0c-1\u6bd40\u5148\u6267\u884c\u3002stop\u65b9\u6cd5\u7684\u6267\u884c\u987a\u5e8f\u5219\u76f8\u53cd\uff0cgetPhase\u8fd4\u56de\u503c\u8f83\u5927\u7c7b\u7684stop\u65b9\u6cd5\u5148\u88ab\u8c03\u7528\uff0c\u5c0f\u7684\u540e\u88ab\u8c03\u7528\u3002\n     */\n    @Override\n    public int getPhase() {\n        return 0;\n    }\n}\n\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u4fee\u6539 AppConfig"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'package com.example.bean.lifecycle;\n\nimport org.springframework.context.annotation.AnnotationConfigApplicationContext;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.ComponentScan;\nimport org.springframework.context.annotation.Configuration;\n\n@ComponentScan(basePackages = {"com.example.bean"})\n@Configuration\npublic class AppConfig {\n    @Bean(initMethod = "selfInit", destroyMethod = "selfDestroy")\n    public Person person() {\n        Person person = new Person();\n        person.setName("tester");\n        person.start();\n        return person;\n    }\n\n    public static void main(String[] args) {\n        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);\n        context.close();\n    }\n}\n\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u6267\u884c\u7ed3\u679c:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:"[InstantiationAwareBeanPostProcessor\u63a5\u53e3]\u8c03\u7528InstantiationAwareBeanPostProcessor\u524d\u7f6e\u65b9\u6cd5, BeanName:person\n[\u6784\u9020\u5668]\u8c03\u7528Person\u7684\u6784\u9020\u5668\u5b9e\u4f8b\u5316\n[\u6ce8\u5165\u5c5e\u6027]\u6ce8\u5165\u5c5e\u6027name\n[InstantiationAwareBeanPostProcessor\u63a5\u53e3]\u8c03\u7528InstantiationAwareBeanPostProcessor\u540e\u7f6e\u65b9\u6cd5, BeanName:person\n[BeanNameAware\u63a5\u53e3]\u8c03\u7528BeanNameAware#setBeanName\n[ApplicationContextAware]\u8c03\u7528ApplicationContextAware#setApplicationContext\n[BeanPostProcessor\u63a5\u53e3]\u8c03\u7528\u4e86BeanPostProcessor\u7684\u524d\u7f6e\u5904\u7406\u65b9\u6cd5\n[PostConstruct\u63a5\u53e3]\u8c03\u7528PostConstruct\u6ce8\u89e3\u7684\u65b9\u6cd5\n[InitializingBean\u63a5\u53e3]\u8c03\u7528InitializingBean#afterPropertiesSet\n[init-method]\u8c03\u7528<bean>\u7684init-method\u5c5e\u6027\u6307\u5b9a\u7684\u521d\u59cb\u5316\u65b9\u6cd5\n[BeanPostProcessor\u63a5\u53e3]\u8c03\u7528\u4e86BeanPostProcessor\u7684\u540e\u7f6e\u5904\u7406\u65b9\u6cd5\n[SmartLifecycle]isRunning\u65b9\u6cd5\u8c03\u7528, running: false\n[SmartLifecycle]start\u65b9\u6cd5\u8c03\u7528, \u542f\u52a8\u5b8c\u6210\n[SmartLifecycle]isRunning\u65b9\u6cd5\u8c03\u7528, running: true\n[SmartLifecycle]stop\u65b9\u6cd5\u8c03\u7528, \u6267\u884c\u56de\u8c03\u51fd\u6570\n[SmartLifecycle]stop\u65b9\u6cd5\u8c03\u7528, running: true\n[PreDestroy\u63a5\u53e3]\u8c03\u7528\u4e86PreDestroy\u6ce8\u89e3\u7684\u65b9\u6cd5\n[DisposableBean\u63a5\u53e3]\u8c03\u7528DisposableBean#destroy\n[destroy-method]\u8c03\u7528<bean>\u7684destroy-method\u5c5e\u6027\u6307\u5b9a\u7684\u9500\u6bc1\u65b9\u6cd5\n\n"})}),"\n",(0,r.jsx)(e.h4,{id:"525-\u603b\u7ed3",children:"5.2.5 \u603b\u7ed3"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\u5982\u679c\u4e00\u4e2a Bean \u5b9e\u73b0\u4e86",(0,r.jsx)(e.code,{children:"SmartLifecycle"}),"\u63a5\u53e3\uff0c\u5f53",(0,r.jsx)(e.code,{children:"Spring"}),"\u5bb9\u5668\u542f\u52a8\u65f6\u4f1a\u81ea\u52a8\u6267\u884c\u5b83\u7684\u542f\u52a8\u65b9\u6cd5\u3002\u5728\u6267\u884c\u542f\u52a8\u65b9\u6cd5\u4e4b\u524d\uff0c\u4f1a\u901a\u8fc7",(0,r.jsx)(e.code,{children:"isRunning()"}),"\u65b9\u6cd5\u68c0\u67e5\u7ec4\u4ef6\u7684\u8fd0\u884c\u72b6\u6001\uff0c\u5982\u679c\u8fd4\u56de\u503c\u4e3a",(0,r.jsx)(e.code,{children:"false"}),"\u8868\u793a\u5c1a\u672a\u6267\u884c\u542f\u52a8\u64cd\u4f5c\uff0c\u6b64\u65f6\u4f1a\u8c03\u7528",(0,r.jsx)(e.code,{children:"start()"}),"\u65b9\u6cd5\u8fdb\u884c\u542f\u52a8\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:["\u5f53",(0,r.jsx)(e.code,{children:"Spring"}),"\u5bb9\u5668\u5173\u95ed\u65f6\uff0c\u4f1a\u68c0\u67e5\u7ec4\u4ef6\u7684\u8fd0\u884c\u72b6\u6001\uff0c\u5e76\u6839\u636e\u60c5\u51b5\u6267\u884c\u5173\u95ed\u64cd\u4f5c\u3002\u5982\u679c\u7ec4\u4ef6\u6b63\u5728\u8fd0\u884c\uff0c\u5219\u4f1a\u8c03\u7528\u76f8\u5e94\u7684\u505c\u6b62\u65b9\u6cd5\u3002\u540c\u65f6\uff0c\u53ef\u4ee5\u5904\u7406\u76f8\u5e94\u7684\u56de\u8c03\u51fd\u6570\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"SmartLifecycle"}),"\u63a5\u53e3\u4e2d\u7684",(0,r.jsx)(e.code,{children:"getPhase()"}),"\u65b9\u6cd5\u8fd4\u56de\u7684\u503c\u8d8a\u5c0f\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u8868\u793a\u5728\u542f\u52a8\u548c\u505c\u6b62\u8fc7\u7a0b\u4e2d\u5148\u6267\u884c"]}),"\n"]})]})}function d(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(p,{...n})}):p(n)}}}]);